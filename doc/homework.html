<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Hongrui Cai" />

<meta name="date" content="2020-12-19" />

<title>Homework Vignette</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Vignette</h1>
<h4 class="author">Hongrui Cai</h4>
<h4 class="date">2020-12-19</h4>



<div id="homework-0" class="section level1">
<h1>Homework 0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book.</p>
<p>The 1st example should contain texts and at least one figure.</p>
<p>The 2nd example should contains texts and at least one table.</p>
<p>The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>The 1st answer contains texts and at least one figure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ctl &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.21</span>,<span class="fl">3.72</span>,<span class="fl">4.37</span>,<span class="fl">5.49</span>,<span class="fl">3.12</span>,<span class="fl">5.34</span>,<span class="fl">7.20</span>,<span class="fl">5.07</span>,<span class="fl">4.10</span>,<span class="fl">3.36</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>trt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.72</span>,<span class="fl">5.28</span>,<span class="fl">3.06</span>,<span class="fl">4.77</span>,<span class="fl">6.31</span>,<span class="fl">4.28</span>,<span class="fl">7.19</span>,<span class="fl">3.71</span>,<span class="fl">5.45</span>,<span class="fl">3.75</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>group &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Ctl&quot;</span>,<span class="st">&quot;Trt&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a>weight &lt;-<span class="st"> </span><span class="kw">c</span>(ctl, trt)</span>
<span id="cb1-5"><a href="#cb1-5"></a>lm.D9 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">plot</span>(lm.D9)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOjoAOpAAZrYNACg6AAA6ADo6AGY6Ojo6OpA6kLY6kNtmAABmADpmZgBmZmZmkJBmtrZmtv+B//+QOgCQOjqQZgCQkGaQtpCQtv+Q2/+2ZgC2kDq2tma225C2/7a2///bkDrbtmbb/7bb///fU2v/tkn/tmb/vFH/25D//7b//9v////e8Yz+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANDklEQVR4nO2di3bjthGGaUeudttKbrKq22zFJjEbp6xkvv/jFXcCFImBcCGH1PznWLZkQqA+AYOZAQhWHcmraukTwC4CBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAGqiJBfAlDlaOlTwiXiAagHdD0euqaqdh9Lng4+9YDq3cdl/9LVL0ueDj4ZQNfjqWsr9vP8vugJYZMDqGZwGgLkyOpiL9fj7uN6pC7myDbS1dP58434uKJhHhABAiQBse5lVNhIi6pG6+DDhKsadsra00i5nJq7BXFPgn3yp/Ptv2IAlYXDNTcg6YeOjgXYAeluVrSLOWRYYFPxpzX7fVIflr920Af0gFr9slvmsmex0e8Ckjrievx2FO+WS06o0bywKst+JW1lCDWsn/EAkDcq+fdJ/L7sNSEDiHdM4aGNlRFg9RHXI3u1GevBkbI86UPXshNqCker/EsXjZRXKCp+PXfie2EfVL5moh0N6PNNvPx0Hisjftwjcn7LTqhx+foufgrr860SDaX/FG0lGsCpFV+9+Y8GJF9gj2Nl5JnrI0RzymmZDCD+HfAvZgZATCzqu3xR/YCZledfZWtolasxCoj9f6yMBUi0wVKARJRaHwp3Md0EWFPRf4rfqru0Tz0AZnInW5BdZq4WJEZgNpKV9RP1KMbMjLYnwuJIG3safLJJG2SXGdqgcoBmUStSli0fkflYw4DJhsBe0KNY70aOj2JumcNwFCsFyEQbc4QakoDyaRr+vFZffmOfQS3P6HDrB+ky7JChH1S4BVFCcaCbLkY5aVc3gKgJuboBRDlpV0NAlJMe6GYUo4lDV5RyBZQZULUa3QcoW066UpTU0xZth70TEJdw/7s2LddUWT8qbYNT9wPSYWRaNF/pqsVjg3dEvB+Qjl+iHEW7a/eAcDQgnuBqxLnZAVpMC5KZhIC5KN/b2YBQWKBWG1V1NspARtkgTjgx3+3YoPrgP3gO1U/fZYpUNWfXSAbIGu/EUJb4pduj2Oc/MPQwnUOW9tA07xhAOWS/Gw4TpABZDagkoEabuqmQFqFfLgFpC9SpxzKA5FQdb6urA6TtYaQNuh4PASlXOdB9vvHpxZUB6u1h/CgGS7tKfJJ6PYD+96e/d91/h198EUDaVerql/UAEn6QcBalWx/fggIWkmss09Nn6AAZP0jZogQ/KGQheaPc9c+3tQAyfpBsQQmjWJ6F5GgBXfYiREgElL6QHC0g5Sqm+EF3LST3Guk78nUzyCxXqbl5SLBBKQvJnUzmXfWXFwfE/WgdbBT0g0LezkmYoZBoQY1eD6BFgABFpjt2H4k5nC0Dap/ODTfSSYQQ2qBxxaVcG08Y2gVNDiEcxcYV5wdxQD5HcdKBduvdJiDdgrxJe9AL2HAXUzao8S/jb4FV/viNdIIfZK0ejK8eO6CUWY1M9aMGlBCLmWxY8glgtkGV6GLR0XyOE+hQj2Jqq5I4I51jcSJaMkqDFQRBJdQfeRaSbxhQjnoR9y2lwhOHgSeAmFOKDcpzAt1mR7FcJ4DbDyJHERSlXMN0J6Csy4Ax2yCjGEcx1zJgzKOYUUwslmkZMNMfeZVwPsCJhhw4jMUQTj2X4B0fzScvA16HomxQpmXAq1B0RjHHMmDUWt4Pwq2FPOnHiOYzTT2j9oNSAD3E1HNCNB8w9Rx0AshjsXgbFDL1HFQ/akAZWpDXUeSLGPkeW5POEn5A6jHaBnmnngUfvgnU5BwRfhukHqMdRZ8jLQy4XEc9FdJiH8XK+kH9Vk+Tlgp7C0rwpPX6X5+RFrsXQi0ItQ0yigEkc4k+QNfj87toQpNpNfyAElrQN76JJTDMq338JpdRoQeU5Ad9vlWHDAkzzDYoYRRTW6zt/pNz7w50SgXEvcAgQL5rNbbcgqQdjqh3dGsKjFooH2TXjxsQgowickBKdwIKuyxcbHTsPwa7DSrcghq9m3pbTaTVsI9iZW2QtRDWG6wiVuwoFrZ4wUpy+IJVzErKB4GLF0JbEOIulgAoZPGCyaZ5bRBqI52Wk+byxmLgdp34h/noUazAHmaYFWWD8ixe2CygbIsXUNsgrQVDDdSjWAYblFh9hvcoqvRRLK7aR1jd8RiXQ+nHqFmNR7gcSj8uaqQxC0FGEbni80FZbuGHH5BSBKAst/DbMKA8t/DbNKAct/DbMKA8t/DbMKA8t/DbMqAst/DbNKBZ611aBAhQkWmfnPUurSLTPr53WUm6w6jMtE/GepdWoWmffPUurQWnfdahQtM+QctfVqEy0z6By1/WIFr+AigCENh9trD8xSgmYQYOX4/dgkIuVg1b/rIKFZo4DFn+sg7Fe9Iz1bu0ov2guepdWqVnVtdz86MJzZwPeoRofuZ6lxbNrAIqNLP6yMFqyMzqQwerATOrIaHGanQ3oICZ1YBgtX/f0BNIKDFLkXtmVgNaUPyJ4AcUMLMKB6vxJ7ICQAECg9X4E0EPSN+6Osti1y0DStuiK/5EkAOq+/Evx4L77QHKfnf47QHKrM0BuuwPYvObxLtDbU8KkIhReU4xcRnw9qSNNE9Ii4kf782wH1Bmawqdts/kB21GGtBJz4wRIFcWIGl+0hZQbU+WDRIrX/JMj21IClD7dOY3Uw+ZoX8waT+oFSH6ZU8dbKD1zGQtJHVHsphs7WOIeAAiQICy9ql+CXHD3lYEdUD8e1tCZnU9voZTRL43FGTfFgFrMepNUMDBgFqTq+YulVhOw69s8FzdMFJC7HgeVEnNisgg21/JWBGoll49l2RM4r4c4i/pbTLnU04UTca/IyWgUKcvIiMj5vgDlYwVuSOgGhJJYNTs/jn8uCp6mTqbkRJqQ++ASmSbYY9AJWNFoFosDXAkNCHWauthh5EteerrGivR1X/25cWtIurTVid/JaNFgFpsOUBSehhv6L0xVGaz/8pCS6iAZ+Lc7SKq4VQnbyXjRfy1OLKQpNlp554c8v4bBz+g0RJSU83BLSIsLgRotIi/FkfVxN/3SrTzwTf1/O5r/eMlOuupv4iYq3r+7fXs7WLjRby1uKomn9ynRsUp0vkJsZ/jJdSpj4/CThF15Nd3r5EeL+KtxVVWR9ptD626hYIvzX1TwvwBFpEKGOZHisC1GBUB1FsUyIe7LSGnDzzmUxcRNwJp9VDgvdb2tghYi1F2QMqj0aNoA4cagxK12yGmi/BwQb43UMlYEagWI4pVAREgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQI0GKA9IXoJ3EpVqt+XE2sSEi6Fdq9Wg6QvSSFf+SRj02AtAjQrQwg9nEve7NnSmOvm/lZAFKrndjfas0KK6GuIT11poB4jwLgUADqW1AjVlke5IKqVq7lUeuHdh/6skgbkC5grmvPLVyAzHXFstXUan0Ug8X+IzbP4P+wAJkCxa5FXnoUOzmAWt2n5OdVNqj/D19N7QAyBa7HQoRwtaBWj/2NDYivKKylfXr+1W1BpoDcwXDzNsgMW04LYs9+O6pdMwZdzB3n6gI7j+ACZAZwtfZZfeDr8Uduszm0Vnexg+pZdqMpMf5jAXSQBlog4Q1BXtyiW0TNr32TjafiR54+3/j66OpkCpj1wLmFAxAjwEZx7QeJ7tX7QZ255wdfw1vzK/wFqeqb9oNk0yqztw8Fq4AIECACBIgAASJAgAgQIAIEaA5Atw7u59uoy+scaJ7cpmLvqDp5+8xlAIVctq5LpcUPbeqGSIsACryPUA5AE201XDMBuuy/sdjgwPOiJ3U164uKIOo+0SpZ1DLIuB5/4kfzImOtQB/1+nMlko/9G/Dqvnzf69RtYhOaDRAPQPlHETvDv8gTbyq5vYfOm8qwTCVbr0cZs463oP4oDkDG+C89IH5tvAzgUgPY2QAd1H6xIkehLvetf9x9XL6cTd70qrM+nQhJ3YwGz4jxbdb+xZ+4R8nrnlsFU1cnG0/q3quzAdIbNeqPzJM6r9+/8mSylTc99amyPu2sbgArgn7V3dyjJATrnfuJkKAby/m0BCD19R8uf/n99cy6m8mbimmKKUCOmhFAVqJRbcawVkDyIze7f7909V/frESrtwU5glrQ2gGJmb6vf2Pm+Ycv534g721QAwByj7Js0EG1UbEZw1ptkNz3QIxScvcsnTcdjGL21NdQzlFmFNOZWDFormwUswHJDmLtiKPypsYPev5FDmnilXrKDzJHddoP0pnYy/6nvZoEWoMfdCPYOQ6bKJ3edcr0q+SJjmWieU8sJj4baFmBo3pAq4jFbuWLkNoqZIrUf5QBtI5oftUiQID+D7UjzsCNNZtsAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>The 2nd answer contains texts and at least one table.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(iris))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>The 3rd answer contains at least a couple of LaTeX formulas.</p>
<p><span class="math display">\[\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i\]</span></p>
<p><span class="math display">\[\begin{align*} 
    a_1x_1+b_1x_2=c_1 \\
    b_1x_1+b_2x_2=c_2
\end{align*}\]</span> —</p>
<p>This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <a href="http://rmarkdown.rstudio.com" class="uri">http://rmarkdown.rstudio.com</a>.</p>
<p>When you click the <strong>Knit</strong> button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">summary</span>(cars)</span></code></pre></div>
<pre><code>##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00</code></pre>
<p>You can also embed plots, for example:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
</div>
</div>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="section" class="section level2">
<h2>3.3</h2>
<p>The Pareto<span class="math inline">\((a, b)\)</span> distribution has cdf <span class="math display">\[\begin{equation}
F(x)=1-(\frac{b}{x})^a,\quad x\geq b&gt;0,a&gt;0.
\end{equation}\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto<span class="math inline">\((2, 2)\)</span> distribution. Graph the density histogram of the sample with the Pareto<span class="math inline">\((2, 2)\)</span> density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>After installing Pareto library manually, we can first propose a function to derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(Pareto)</span>
<span id="cb5-2"><a href="#cb5-2"></a>my_pareto &lt;-<span class="st"> </span><span class="cf">function</span>(n, a, b){</span>
<span id="cb5-3"><a href="#cb5-3"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4"></a>  x &lt;-<span class="st"> </span>b<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a))</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="kw">return</span>(x)</span>
<span id="cb5-6"><a href="#cb5-6"></a>}</span></code></pre></div>
<p>Then we can simulate a random sample from the proposed method and use Pareto library to obtain another random sample with the Pareto<span class="math inline">\((2, 2)\)</span> density as ground-truth (GT) for comparison.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e3</span>; a &lt;-<span class="st"> </span><span class="dv">2</span>; b &lt;-<span class="st"> </span><span class="dv">2</span>; xmin_ &lt;-<span class="st"> </span><span class="dv">2</span>; xmax_ &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>X_mine &lt;-<span class="st"> </span><span class="kw">my_pareto</span>(n, a, b)</span>
<span id="cb6-4"><a href="#cb6-4"></a>X_gt &lt;-<span class="st"> </span><span class="kw">rPareto</span>(n, a, b)</span></code></pre></div>
<p>At last, we can draw two density histograms of two samples in one graph or separately in two graphs.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">hist</span>(X_mine, <span class="dt">breaks=</span><span class="dv">500</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>p2 &lt;-<span class="st"> </span><span class="kw">hist</span>(X_gt, <span class="dt">breaks=</span><span class="dv">500</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">height=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">plot</span>(p1, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Histogram of my_pareto and rpareto&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw">plot</span>(p2, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">1</span>))</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">5</span>))</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">plot</span>(p1, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">main=</span><span class="st">&quot;Histogram of my_pareto&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">plot</span>(p2, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">main=</span><span class="st">&quot;Histogram of rpareto&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the first graph, the blue bars represent the histogram of the random sample created by my proposed method, while the red ones represent the histogram of the random sample using Pareto library. Note that for the sake of beauty, we only show the data between <span class="math inline">\(2\)</span> and <span class="math inline">\(20\)</span> in the experiment.</p>
</div>
<div id="section-1" class="section level2">
<h2>3.9</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[\begin{equation}
f_e(x) = \frac{3}{4}(1-x^2),\quad |x|\leq 1.
\end{equation}\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\sim{Uniform(-1,1)}\)</span>. If <span class="math inline">\(|U_3|\geq |U_2|\)</span> and <span class="math inline">\(|U_3|\geq |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>First, we need to propose a function as the algorithm Devroye and Gyorfi given:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>my_kernel &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="kw">set.seed</span>(<span class="dv">1</span>); u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="kw">set.seed</span>(<span class="dv">2</span>); u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="kw">set.seed</span>(<span class="dv">3</span>); u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="co"># compare |u3| and |u2|</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  compare_<span class="dv">32</span> &lt;-<span class="st"> </span>(<span class="kw">abs</span>(u3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u2)) <span class="op">+</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="co"># compare |u3| and |u1|</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  compare_<span class="dv">31</span> &lt;-<span class="st"> </span>(<span class="kw">abs</span>(u3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u1)) <span class="op">+</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="co"># record the position of &quot;(|u3| &gt;= |u2|) &amp;&amp; (|u3| &gt;= |u1|)&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  compare_final &lt;-<span class="st"> </span>((compare_<span class="dv">32</span><span class="op">+</span>compare_<span class="dv">31</span>)<span class="op">==</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="kw">return</span>(u2<span class="op">*</span>compare_final <span class="op">+</span><span class="st"> </span>u3<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>compare_final))</span>
<span id="cb10-12"><a href="#cb10-12"></a>}</span></code></pre></div>
<p>As the codes shown, we propose a method for parallel processing. Then, after setting <span class="math inline">\(n\)</span> in the experiment, we can use this function to simulate the symmetric density function <span class="math inline">\(f_e\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e6</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>X &lt;-<span class="st"> </span><span class="kw">my_kernel</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">hist</span>(X, <span class="dt">breaks=</span><span class="dv">200</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Simulated random variates&quot;</span>))</span>
<span id="cb11-4"><a href="#cb11-4"></a>Y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="kw">lines</span>(Y, <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Y<span class="op">^</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;dark red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that the red line in the graph represents function <span class="math inline">\(f_e\)</span>. It shows that the simulated random variates almost obey the symmetric density function <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="section-2" class="section level2">
<h2>3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>We can find an equivalent form of the algorithm in Exercise 3.9, as:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generate iid <span class="math inline">\(V_1,V_2,V_3\sim{Uniform(0,1)}\)</span>.</p></li>
<li><p>With the same probability, we select <span class="math inline">\(X\)</span> from one of the two smallest variables of <span class="math inline">\(V_i\)</span>.</p></li>
<li><p>Then, we negate <span class="math inline">\(X\)</span> with <span class="math inline">\(\frac{1}{2}\)</span> probability at random.</p></li>
</ol>
<p>We can find (a) and (b) replace the original states in Exercise 3.9, so the problem is translated to: prove the distribution of <span class="math inline">\(X\)</span> obey the density <span class="math inline">\(f_e\)</span>. Let <span class="math inline">\(0&lt;x&lt;1\)</span>. As step (a) shown, there are two possibilities: (1) at least two of <span class="math inline">\(V_i\)</span> lie in <span class="math inline">\([0,x]\)</span>; (2) or only one lie in <span class="math inline">\([0,x]\)</span> but we choose it luckily. In formula, the probability is calculated as: <span class="math display">\[\begin{equation}
F(x)=C_3^2 x^2(1-x)+C_3^3 x^3+\frac{1}{2}C_3^1 x(1-x)^2=\frac{1}{2}(3x-x^3)
\end{equation}\]</span></p>
<p>Then, the density function is <span class="math display">\[\begin{equation}
f(x)=F^{&#39;}(x)=\frac{3}{2}(1-x^2)
\end{equation}\]</span></p>
<p>In the end, combining part (c), we can find that: <span class="math display">\[\begin{equation}
f_e(x)=\frac{1}{2}f(x)=\frac{3}{4}(1-x^2)
\end{equation}\]</span></p>
<p>So we have proven the algorithm.</p>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[\begin{equation}
F(y)=1-(\frac{\beta}{\beta+y})^r,\quad y\geq 0.
\end{equation}\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate <span class="math inline">\(1000\)</span> random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The mixture in Exercise 3.12 can be represented as:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e3</span>; r &lt;-<span class="st"> </span><span class="dv">4</span>; beta &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">set.seed</span>(<span class="dv">313</span>); lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">set.seed</span>(<span class="dv">31313</span>); x &lt;-<span class="st"> </span><span class="kw">rexp</span>(lambda)</span></code></pre></div>
<p>where <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. And as Exercise 3.12, we can obtain the Pareto cdf with Pareto library:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(Pareto)</span>
<span id="cb13-2"><a href="#cb13-2"></a>xfit &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span>n, <span class="dv">10</span>, <span class="dt">length=</span>n)</span>
<span id="cb13-3"><a href="#cb13-3"></a>y1 &lt;-<span class="st"> </span><span class="kw">dPareto</span>(xfit<span class="op">+</span>beta, r, beta)</span>
<span id="cb13-4"><a href="#cb13-4"></a>y2 &lt;-<span class="st"> </span><span class="kw">dPareto</span>(xfit<span class="op">+</span>beta, <span class="dv">2</span>, beta)</span></code></pre></div>
<p>Note that we simulate two different Pareto cumulative distribution functions with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(r=2\)</span>. In the end, we put three cumulative distribution functions in one graph.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">lines</span>(xfit, y1, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">lines</span>(xfit, y2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>where the density histogram represents the sample created by the mixture distribution, the blue line is the Pareto density curve with <span class="math inline">\(r=4,\beta=2\)</span>, and the red line is the Pareto density curve with <span class="math inline">\(r=2,\beta=2\)</span>. It shows that the red line seems closer to the mixture distribution.</p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="section-4" class="section level2">
<h2>5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\begin{equation}
\int_{0}^{\pi/3}\sin t\,\mathrm{d}t
\end{equation}\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>If <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are finite, then <span class="math display">\[\int_a^b h(x)dx = \int_a^b g(x)\frac1{b-a}dx=E[g(X)],\]</span> where <span class="math inline">\(X\sim U(a,b),g(x)=(b-a)h(x).\)</span></p>
<p>So we have: <span class="math display">\[\begin{equation}
\int_{0}^{\pi/3}\sin t\,\mathrm{d}t = \frac{\pi}{3}E[\sin T], T\sim U(0,\frac{\pi}{3}).
\end{equation}\]</span></p>
<p>Then we can use R to compute a Monte Carlo estimate of it:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">819</span>); m &lt;-<span class="st"> </span><span class="fl">1e5</span>; t &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(t)) <span class="op">*</span><span class="st"> </span>pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<p>Its estimated and exact value are:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.4998814 0.5000000</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>As before, we give a simple estimator: <span class="math display">\[\begin{equation}
\hat{\theta} = \frac{1}{m}\sum\limits_{j=1}^{m}e^{X_{j}},X_{j}\sim U(0,1).
\end{equation}\]</span></p>
<p>Then use R to estimate <span class="math inline">\(\theta\)</span> by the simple Monte Carlo method:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">set.seed</span>(<span class="dv">819</span>); m &lt;-<span class="st"> </span><span class="fl">1e6</span>; x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>theta_hat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(x1)</span></code></pre></div>
<p>What’s more, we give a estimator by the antithetic variate approach: <span class="math display">\[\begin{equation}
\hat\theta&#39; = \frac{1}{m}\sum\limits_{j=1}^{m/2}(e^{X_{j}}+e^{1-X_{j}}),X_{j}\sim U(0,1).
\end{equation}\]</span></p>
<p>Then we use R to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">521</span>); m &lt;-<span class="st"> </span><span class="fl">5e5</span>; x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>);</span>
<span id="cb19-2"><a href="#cb19-2"></a>theta_hat_<span class="dv">2</span> &lt;-<span class="st"> </span>(<span class="kw">exp</span>(x2) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p>We can compute an empirical estimate of the percent reduction in variance using the antithetic variate:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(theta_hat_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(theta_hat_<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] 0.01613777</code></pre>
<p>It shows that the variance drops obviously. We can also verify the inequation in the page 14 of PPT:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(theta_hat_<span class="dv">2</span>), (<span class="kw">var</span>(<span class="kw">exp</span>(x2))<span class="op">+</span><span class="kw">var</span>(<span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2)))<span class="op">/</span><span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 0.003910131 0.120992472</code></pre>
<p>Then we can compare the estimated value by a simple Monte Carlo method and the estimated value by the antithetic variate approach with the theoretical value:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta_hat_<span class="dv">1</span>), <span class="kw">mean</span>(theta_hat_<span class="dv">2</span>), <span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 1.718247 1.718268 1.718282</code></pre>
</div>
<div id="section-6" class="section level2">
<h2>5.11</h2>
<p>If <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*} = 1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_{c} = c\hat\theta_{1} + (1-c)\hat\theta_{2}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_{c} = c\hat\theta_{1}+(1-c)\hat\theta_{2}\)</span> in equation (5.11). (<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>It is known that antithetic variate is actually a special case of the control variate estimator. The variance of <span class="math inline">\(\hat\theta_{c} = c\hat\theta_{1} + (1-c)\hat\theta_{2}\)</span> is: <span class="math display">\[\begin{equation}
\mathrm{Var}(\hat\theta_{2})+c^{2}\mathrm{Var}(\hat\theta_{1}-\hat\theta_{2})+2\mathrm{Cov}(\hat\theta_{2},\hat\theta_{1}-\hat\theta_{2}).
\end{equation}\]</span> For antithetic variates, <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are identically distributed and <span class="math inline">\(\mathrm{Cor}(\hat\theta_{1}, \hat\theta_{2}) = -1\)</span>. Then <span class="math inline">\(\mathrm{Cov}(\hat\theta_{1}, \hat\theta_{2}) = -\mathrm{Var}(\hat\theta_{1})\)</span>, the variance is <span class="math display">\[\begin{equation}
\begin{aligned}
\mathrm{Var}(\hat\theta_{c}) &amp;= 4c^{2}\mathrm{Var}(\hat\theta_{1})-4c\mathrm{Var}(\hat\theta_{1})+\mathrm{Var}(\hat\theta_{1})\\&amp;= (4c^{2}-4c+1)\mathrm{Var}(\hat\theta_{1}),
\end{aligned}
\end{equation}\]</span> so the optimal constant is <span class="math inline">\(c^{*} = 1/2\)</span>. The control variate estimator in this case is <span class="math inline">\(\hat\theta_{c^{*}} = \frac{\hat\theta_{1}+\hat\theta_{2}}{2}\)</span>, which is the antithetic variable estimator of <span class="math inline">\(\theta\)</span>.</p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="section-7" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{equation}
g(x) = \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad x&gt;1.
\end{equation}\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\begin{equation}
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\end{equation}\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>I choose <span class="math inline">\(f_0(x) = 1\)</span> and <span class="math inline">\(f_1(x) = e^{-x}\)</span> as two importance functions. Firstly, I draw these 3 functions in a figure as comparison.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>  w &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  g &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="co"># g(x)</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  f0 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(x)) <span class="co"># f0(x)</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  f1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="co"># f1(x)</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)),</span>
<span id="cb26-7"><a href="#cb26-7"></a>          <span class="kw">expression</span>(f[<span class="dv">0</span>](x)<span class="op">==</span><span class="dv">1</span>),</span>
<span id="cb26-8"><a href="#cb26-8"></a>          <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x}))</span>
<span id="cb26-9"><a href="#cb26-9"></a>  </span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="co"># for color change lty to col</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb26-12"><a href="#cb26-12"></a>  <span class="co"># figure (1)</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb26-14"><a href="#cb26-14"></a>       <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">main=</span><span class="st">&#39;(1)&#39;</span>)</span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="kw">lines</span>(x, f0, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">3</span>)</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="co"># figure (2)</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="kw">plot</span>(x, g<span class="op">/</span>f0, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&#39;(2)&#39;</span>)</span>
<span id="cb26-20"><a href="#cb26-20"></a>  <span class="kw">lines</span>(x, g<span class="op">/</span>f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">3</span>)</span>
<span id="cb26-21"><a href="#cb26-21"></a>  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>], <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Secondly, I compare the variances of <span class="math inline">\(f_0\)</span> and <span class="math inline">\(f_1\)</span> in approximatively estimating <span class="math inline">\(\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>  <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>  x_min &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  x_max &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>  theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span>var &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x, x_min_, x_max_) {</span>
<span id="cb27-7"><a href="#cb27-7"></a>    x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span>x_min_) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;=</span><span class="st"> </span>x_max_)</span>
<span id="cb27-8"><a href="#cb27-8"></a>  } <span class="co"># define g(x)</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>  x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, x_min, x_max) <span class="co"># using f0</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x, x_min, x_max)</span>
<span id="cb27-11"><a href="#cb27-11"></a>  theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb27-12"><a href="#cb27-12"></a>  se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb27-13"><a href="#cb27-13"></a>  var[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb27-14"><a href="#cb27-14"></a>  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, <span class="dv">1</span>) <span class="co"># using f1</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x, x_min, x_max) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</span>
<span id="cb27-16"><a href="#cb27-16"></a>  theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb27-17"><a href="#cb27-17"></a>  se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb27-18"><a href="#cb27-18"></a>  var[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb27-19"><a href="#cb27-19"></a>  <span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">round</span>(var, <span class="dv">6</span>))) <span class="co"># the variances of f0 and f1</span></span></code></pre></div>
<pre><code>## [1] 0.000104 0.345851</code></pre>
<p>I find that <span class="math inline">\(f_0(x) = 1\)</span> produces the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> by importance sampling. Because compared with <span class="math inline">\(f_1(x) = e^{-x}\)</span>, <span class="math inline">\(f_0(x) = 1\)</span> is closer to the form of <span class="math inline">\(g(\cdot) = c f(\cdot)\)</span> for some constant <span class="math inline">\(c\)</span> in the interval <span class="math inline">\([1, \infty]\)</span>.</p>
</div>
<div id="modified-5.13" class="section level2">
<h2>(Modified) 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((0,1)\)</span> and are ‘close’ to <span class="math display">\[\begin{equation}
g(x) = \frac{e^{-x}}{1+x^2},\quad 0&lt;x&lt;1.
\end{equation}\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\begin{equation}
\int^1_0 \frac{e^{-x}}{1+x^2}dx
\end{equation}\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>I choose <span class="math inline">\(f_0(x) = \frac{1}{\pi(1+x^2)}\)</span> and <span class="math inline">\(f_1(x) = \frac{e^{-x}}{1-e^{-1}}\)</span> as two importance functions. Firstly, I draw these 3 functions in a figure as comparison.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>  w &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="co"># g(x)</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  f0 &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>pi) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="co"># f0(x)</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  f1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="co"># f1(x)</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x}<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb29-7"><a href="#cb29-7"></a>          <span class="kw">expression</span>(f[<span class="dv">0</span>](x)<span class="op">==</span><span class="dv">1</span><span class="op">/</span>pi<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb29-8"><a href="#cb29-8"></a>          <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x}<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>e<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})))</span>
<span id="cb29-9"><a href="#cb29-9"></a>  </span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="co"># for color change lty to col</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="co"># figure (1)</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>  <span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-14"><a href="#cb29-14"></a>       <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">main=</span><span class="st">&#39;(1)&#39;</span>)</span>
<span id="cb29-15"><a href="#cb29-15"></a>  <span class="kw">lines</span>(x, f0, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">3</span>)</span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="co"># figure (2)</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>  <span class="kw">plot</span>(x, g<span class="op">/</span>f0, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&#39;(2)&#39;</span>)</span>
<span id="cb29-20"><a href="#cb29-20"></a>  <span class="kw">lines</span>(x, g<span class="op">/</span>f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">col =</span> <span class="dv">3</span>)</span>
<span id="cb29-21"><a href="#cb29-21"></a>  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>], <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Secondly, I compare the variances of <span class="math inline">\(f_0\)</span> and <span class="math inline">\(f_1\)</span> in approximatively estimating <span class="math inline">\(\int^1_0 \frac{e^{-x}}{1+x^2}dx\)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>  <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>  m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span>var &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>  }</span>
<span id="cb30-7"><a href="#cb30-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(m) <span class="co"># using f0</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb30-9"><a href="#cb30-9"></a>  x[i] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dcauchy</span>(x)</span>
<span id="cb30-11"><a href="#cb30-11"></a>  theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb30-12"><a href="#cb30-12"></a>  se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb30-13"><a href="#cb30-13"></a>  var[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb30-14"><a href="#cb30-14"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co"># using f1, inverse transform method</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>  x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb30-16"><a href="#cb30-16"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb30-17"><a href="#cb30-17"></a>  theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb30-18"><a href="#cb30-18"></a>  se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb30-19"><a href="#cb30-19"></a>  var[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb30-20"><a href="#cb30-20"></a>  <span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">round</span>(var, <span class="dv">6</span>))) <span class="co"># the variances of f0 and f1</span></span></code></pre></div>
<pre><code>## [1] 0.909176 0.009495</code></pre>
<p>I find that <span class="math inline">\(f_1(x) = \frac{e^{-x}}{1-e^{-1}}\)</span> produces the smaller variance in estimating <span class="math inline">\(\int^1_0 \frac{e^{-x}}{1+x^2}dx\)</span> by importance sampling. Because compared with <span class="math inline">\(f_0(x) = \frac{1}{\pi(1+x^2)}\)</span>, <span class="math inline">\(f_1(x) = \frac{e^{-x}}{1-e^{-1}}\)</span> is closer to the form of <span class="math inline">\(g(\cdot) = c f(\cdot)\)</span> for some constant <span class="math inline">\(c\)</span> in the interval <span class="math inline">\([0, 1]\)</span>.</p>
</div>
<div id="section-8" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>The integration in 5.13 can be written as <span class="math display">\[\begin{align*}
\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx \approx&amp; \sum_{i=1}^k \int_i^{i+1} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\\
=&amp;\sum_{i=1}^k \int_i^{i+1}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}*1dx\\
=&amp;\sum_{i=1}^k E\frac{X_i^2*e^{-X_i^2/2}}{\sqrt{2\pi}},\quad k\rightarrow\infty \\
&amp;\text{where }X_i\sim U(i,i+1).\\
\end{align*}\]</span></p>
<p>So we can use R to estimate the integration by the stratified importance sampling.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>  m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  k_max &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co"># number of times to repeat the estimation</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb32-6"><a href="#cb32-6"></a>    count &lt;-<span class="st"> </span><span class="fl">0.0</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k_max){</span>
<span id="cb32-8"><a href="#cb32-8"></a>      x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, j, j<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb32-9"><a href="#cb32-9"></a>      y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb32-10"><a href="#cb32-10"></a>      count &lt;-<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-11"><a href="#cb32-11"></a>    }</span>
<span id="cb32-12"><a href="#cb32-12"></a>    est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span>count</span>
<span id="cb32-13"><a href="#cb32-13"></a>  }</span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="kw">apply</span>(est, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.4007807</code></pre>
<p>We can also use the same method to obtain the result of Example 5.10.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>  m &lt;-<span class="st"> </span><span class="dv">10000</span>; k &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  r &lt;-<span class="st"> </span>m<span class="op">/</span>k <span class="co"># replicates per stratum</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co"># number of times to repeat the estimation</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb34-5"><a href="#cb34-5"></a>  est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a>  g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T2[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)))</span>
<span id="cb34-9"><a href="#cb34-9"></a>    est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</span>
<span id="cb34-10"><a href="#cb34-10"></a>  }</span>
<span id="cb34-11"><a href="#cb34-11"></a>  <span class="kw">apply</span>(est, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.5248031</code></pre>
</div>
<div id="modified-5.15" class="section level2">
<h2>(Modified) 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Modified Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>The integration in (Modified) 5.13 can be written as <span class="math display">\[\begin{align*}
\int^1_0 \frac{e^{-x}}{1+x^2}dx =&amp; \sum_{i=1}^k \int_{\frac{i-1}{k}}^{\frac{i}{k}} \frac{e^{-x}}{1+x^2} dx\\
=&amp;\frac1k\sum_{i=1}^k \int_{\frac{i-1}{k}}^{\frac{i}{k}} \frac{e^{-x}}{1+x^2} kdx\\
=&amp;\frac1k\sum_{i=1}^k E\frac{e^{-X_i}}{1+X_i^2}, \\
&amp;\text{where }X_i\sim U(\frac{i-1}{k},\frac{i}{k}).\\
\end{align*}\]</span></p>
<p>So we can use R to estimate the integration by the stratified importance sampling and compared the result of Example 5.10.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>  <span class="kw">set.seed</span>(<span class="dv">819</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>  M &lt;-<span class="st"> </span><span class="dv">10000</span>; k &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k</span>
<span id="cb36-4"><a href="#cb36-4"></a>  N &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># number of times to repeat the estimation</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb36-6"><a href="#cb36-6"></a>  est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a>  g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb36-9"><a href="#cb36-9"></a>    est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M)))</span>
<span id="cb36-10"><a href="#cb36-10"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T2[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)))</span>
<span id="cb36-11"><a href="#cb36-11"></a>    est[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</span>
<span id="cb36-12"><a href="#cb36-12"></a>  }</span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="kw">apply</span>(est, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.5246896 0.5248044</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>  <span class="kw">apply</span>(est, <span class="dv">2</span>, sd)</span></code></pre></div>
<pre><code>## [1] 2.696132e-03 4.885401e-05</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>  <span class="kw">apply</span>(est, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 7.269127e-06 2.386715e-09</code></pre>
<p>It shows that the variance of the results created by the stratified importance sampling is smaller.</p>
</div>
<div id="section-9" class="section level2">
<h2>6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(Z\)</span> be a standard normal variable, and let <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma &gt; 0\)</span> be two real numbers. Then, the distribution of the random variable <span class="math inline">\(X = e^{\mu+\sigma Z}\)</span> is called the log-normal distribution with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. These are the expected value and standard deviation of the variable’s natural logarithm, not the expectation and standard deviation of <span class="math inline">\(X\)</span> itself.</p>
<p>Let <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\varphi\)</span> be respectively the cumulative probability distribution function and the probability density function of the <span class="math inline">\(N(0,1)\)</span> distribution, then we have that <span class="math display">\[\begin{align*}
f_X(x) =&amp; \frac{d}{dx}Pr(X\le x) = \frac{d}{dx}Pr(\ln X\le \ln x) = \frac{d}{dx}\Phi(\frac{\ln x-\mu}{\sigma})\\
=&amp;\varphi(\frac{\ln x-\mu}{\sigma})\frac{d}{dx}(\frac{\ln x-\mu}{\sigma}) = \varphi(\frac{\ln x-\mu}{\sigma})\frac{1}{\sigma x}\\
=&amp;\frac{1}{x\sigma\sqrt{2\pi}}\exp(-\frac{(\ln x - \mu)^2}{2\sigma^2})
\end{align*}\]</span></p>
<p>Then theoretically, given a random sample <span class="math inline">\(X_1,...,X_n\)</span> from a log-normal distribution, the 95% for the parameter <span class="math inline">\(\mu\)</span> is: <span class="math display">\[\begin{equation}
(E(\ln X)-1.96*\sqrt{Var(\ln X)},E(\ln X)+1.96*\sqrt{Var(\ln X)}),
\end{equation}\]</span> where <span class="math inline">\(E(\ln X)\)</span> is the mean of variable <span class="math inline">\(\ln X\)</span>, <span class="math inline">\(Var(\ln X)\)</span> is the variance of <span class="math inline">\(\ln X\)</span>. We can use a Monte Carlo method to check it:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>  <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>  m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>  X &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(m)</span>
<span id="cb42-4"><a href="#cb42-4"></a>  mean &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(X)); sd &lt;-<span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(X))</span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="kw">print</span>(<span class="kw">c</span>(mean <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>sd, mean <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>sd))</span></code></pre></div>
<pre><code>## [1] -1.993812  1.971829</code></pre>
<p>It shows that ECP is visibly greater than the nominal level, then the CI is said to be conservative. Then we can use MC experiments to approximated the type-1 error rate:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>  alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">20</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a>  beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb44-4"><a href="#cb44-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb44-6"><a href="#cb44-6"></a>    y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rlnorm</span>(n)</span>
<span id="cb44-7"><a href="#cb44-7"></a>    coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</span>
<span id="cb44-8"><a href="#cb44-8"></a>    beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb44-9"><a href="#cb44-9"></a>    p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>]</span>
<span id="cb44-10"><a href="#cb44-10"></a>  }</span>
<span id="cb44-11"><a href="#cb44-11"></a>  p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</span>
<span id="cb44-12"><a href="#cb44-12"></a>  <span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.0542 0.0542</code></pre>
<p>It shows that the t1e rate is visibly greater than <span class="math inline">\(\alpha\)</span>, then the test is said to be liberal.</p>
</div>
<div id="section-10" class="section level2">
<h2>6.5</h2>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>As Example 6.4, we can use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>, as</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>  alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">20</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a>  beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb46-4"><a href="#cb46-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb46-6"><a href="#cb46-6"></a>    y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb46-7"><a href="#cb46-7"></a>    coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</span>
<span id="cb46-8"><a href="#cb46-8"></a>    beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb46-9"><a href="#cb46-9"></a>    p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>]</span>
<span id="cb46-10"><a href="#cb46-10"></a>  }</span>
<span id="cb46-11"><a href="#cb46-11"></a>  p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</span>
<span id="cb46-12"><a href="#cb46-12"></a>  <span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.0499 0.0499</code></pre>
<p>It shows compared with Example 6.4, the t1e rate is visibly smaller than <span class="math inline">\(\alpha\)</span>, then the test is said to be convervative (inflated false negative findings).</p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="section-11" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\upsilon)\)</span>?</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p>Before the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions, we must check if its t1e rate is controlled around the nominal level <span class="math inline">\(\alpha\)</span>. Null hypothesis is defined as: <span class="math display">\[\begin{equation}
H_0:\beta=0\leftrightarrow H_a:\beta\not=0
\end{equation}\]</span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># null hypothesis</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb48-4"><a href="#cb48-4"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb48-6"><a href="#cb48-6"></a>  y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># beta distribution</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>  coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</span>
<span id="cb48-8"><a href="#cb48-8"></a>  beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb48-9"><a href="#cb48-9"></a>  p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>}</span>
<span id="cb48-11"><a href="#cb48-11"></a>p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</span>
<span id="cb48-12"><a href="#cb48-12"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.052 0.052</code></pre>
<p>We can see that the t1e rate is controlled around the nominal level, so we can estimate the power of the skewness test for <span class="math inline">\(Beta(\alpha,\alpha)\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">-1</span> <span class="co"># Alternative hypothesis</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb50-4"><a href="#cb50-4"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb50-6"><a href="#cb50-6"></a>  y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># beta distribution</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>  coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</span>
<span id="cb50-8"><a href="#cb50-8"></a>  beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb50-9"><a href="#cb50-9"></a>  p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>}</span>
<span id="cb50-11"><a href="#cb50-11"></a>p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 1 1</code></pre>
<p>We find the power is as large as possible with t1e rate controlled around the level, so the test is good for <span class="math inline">\(Beta(\alpha,\alpha)\)</span>. This fact can be shown by the comparison with the skewness test for <span class="math inline">\(t(\upsilon)\)</span> as follows:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">-1</span> <span class="co"># Alternative hypothesis</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb52-3"><a href="#cb52-3"></a>beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb52-4"><a href="#cb52-4"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb52-6"><a href="#cb52-6"></a>  y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n, <span class="dv">1</span>) <span class="co"># t distribution</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>  coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</span>
<span id="cb52-8"><a href="#cb52-8"></a>  beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb52-9"><a href="#cb52-9"></a>  p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></span>
<span id="cb52-10"><a href="#cb52-10"></a>}</span>
<span id="cb52-11"><a href="#cb52-11"></a>p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</span>
<span id="cb52-12"><a href="#cb52-12"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.1024 0.1024</code></pre>
</div>
<div id="section-12" class="section level2">
<h2>6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\dot{=}0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>First, I use Monte Carlo methods to estimate the significance level of the test when each example is centered by subtracting its sample mean. The function <span class="math inline">\(count5test\)</span> returns the value 1 (reject <span class="math inline">\(H_0\)</span>) or 0 (do not reject <span class="math inline">\(H_0\)</span>).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y)</span>
<span id="cb54-2"><a href="#cb54-2"></a>{</span>
<span id="cb54-3"><a href="#cb54-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb54-4"><a href="#cb54-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb54-5"><a href="#cb54-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb54-6"><a href="#cb54-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb54-7"><a href="#cb54-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)) <span class="co"># return 1 (reject H0) or 0 (do not reject H0)</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>}</span></code></pre></div>
<p>We can test it by setting the sample size to <span class="math inline">\(20\)</span> (medium):</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>test_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb55-7"><a href="#cb55-7"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb55-8"><a href="#cb55-8"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb55-9"><a href="#cb55-9"></a>x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co"># centered by sample mean</span></span>
<span id="cb55-10"><a href="#cb55-10"></a>y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb55-11"><a href="#cb55-11"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb55-12"><a href="#cb55-12"></a>}))</span>
<span id="cb55-13"><a href="#cb55-13"></a><span class="kw">print</span>(test_mean)</span></code></pre></div>
<pre><code>## [1] 0.324</code></pre>
<p>The empirical power of the test is <span class="math inline">\(0.324\)</span>(<span class="math inline">\(se&lt;0.005\)</span>) against the alternative(<span class="math inline">\(\sigma_1=1,\sigma_2=1.5\)</span>). Then we can compare it with the <span class="math inline">\(F\)</span> test of equal variance at significance level <span class="math inline">\(\hat{\alpha}\dot{=}0.055\)</span>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb57-6"><a href="#cb57-6"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="kw">print</span>(<span class="kw">var.test</span>(x, y,<span class="dt">conf.level =</span> <span class="fl">0.945</span>)) <span class="co"># at significance level 0.055</span></span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 0.45214, num df = 19999, denom df = 19999, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.4400389 0.4645829
## sample estimates:
## ratio of variances 
##          0.4521443</code></pre>
<p>It shows that for medium sample sizes (<span class="math inline">\(20\)</span>), both Count Five test and <span class="math inline">\(F\)</span> test have a great power. We can also compare them in the case of small sample size.</p>
<pre><code>## [1] 0.016</code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 0.43201, num df = 5999, denom df = 5999, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.4111272 0.4539606
## sample estimates:
## ratio of variances 
##          0.4320134</code></pre>
<p>It shows that for small sample sizes (<span class="math inline">\(6\)</span>), <span class="math inline">\(F\)</span> test still have a great power, while Count Five test do not. We can also compare them in the case of large sample size.</p>
<pre><code>## [1] 0.825</code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 0.44903, num df = 99999, denom df = 99999, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.4436107 0.4545099
## sample estimates:
## ratio of variances 
##          0.4490273</code></pre>
<p>It shows that for large sample sizes (<span class="math inline">\(100\)</span>), both Count Five test and <span class="math inline">\(F\)</span> test have a great power.</p>
</div>
<div id="c" class="section level2">
<h2>6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\begin{equation}
\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.
\end{equation}\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[\begin{equation}
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\overline{X})^T\hat{\Sigma}^{-1}(X_j-\overline{X}))^3,
\end{equation}\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom. ]</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>Through Example 6.8, we show the Count Five test of the normal distributions. This time we use Mardia’s multivariate skewness test on it as follows:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>n &lt;-<span class="st"> </span><span class="fl">5e3</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb63-4"><a href="#cb63-4"></a>x[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="kw">set.seed</span>(<span class="dv">521</span>)</span>
<span id="cb63-6"><a href="#cb63-6"></a>x[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb63-7"><a href="#cb63-7"></a>result &lt;-<span class="st"> </span><span class="kw">mvn</span>(<span class="dt">data =</span> x, <span class="dt">mvnTest =</span> <span class="st">&quot;mardia&quot;</span>)</span>
<span id="cb63-8"><a href="#cb63-8"></a><span class="kw">print</span>(result<span class="op">$</span>multivariateNormality)</span></code></pre></div>
<pre><code>##              Test         Statistic            p value Result
## 1 Mardia Skewness  9.77575142862938 0.0443793751368508     NO
## 2 Mardia Kurtosis 0.895524494937974  0.370506777684634    YES
## 3             MVN              &lt;NA&gt;               &lt;NA&gt;     NO</code></pre>
<p>What’s more, we can also use the method on the lognormal distributions as Example 6.10 as follows:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>n &lt;-<span class="st"> </span><span class="fl">5e3</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb65-4"><a href="#cb65-4"></a>x[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n)</span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="kw">set.seed</span>(<span class="dv">521</span>)</span>
<span id="cb65-6"><a href="#cb65-6"></a>x[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n)</span>
<span id="cb65-7"><a href="#cb65-7"></a>result &lt;-<span class="st"> </span><span class="kw">mvn</span>(<span class="dt">data =</span> x, <span class="dt">mvnTest =</span> <span class="st">&quot;mardia&quot;</span>)</span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="kw">print</span>(result<span class="op">$</span>multivariateNormality)</span></code></pre></div>
<pre><code>##              Test        Statistic p value Result
## 1 Mardia Skewness 38055.6712479019       0     NO
## 2 Mardia Kurtosis 683.587442148274       0     NO
## 3             MVN             &lt;NA&gt;    &lt;NA&gt;     NO</code></pre>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with <span class="math inline">\(10,000\)</span> experiments: say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. Can we say the powers are different at <span class="math inline">\(0.05\)</span> level? (a) What is the corresponding hypothesis test problem? (b) What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? (c) What information is needed to test your hypothesis?</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: lower-alpha">
<li><p>We can define the power of the first method as <span class="math inline">\(p_1\)</span>, while the power of another one as <span class="math inline">\(p_2\)</span>. The corresponding hypothesis test problem is: <span class="math display">\[\begin{equation}
H_0:p_1\not=p_2\leftrightarrow H_1:p_1=p_2
\end{equation}\]</span></p></li>
<li><p>Since the two-sample t-test needs two samples be linearly independent (not satisfied in 10,000 synchronous experiments), we could not use two-sample t-test. However, we can use Z-test, paired-t test or McNemar test for the corresponding hypothesis test problem.</p></li>
<li><p>For the Z-test, we need to record the t-test p-value in each experiment of power and test if <span class="math inline">\(p_1-p_2=0\)</span>; for the paired-t test,the message we need is the same; for McNemar test, the message is a bit different, since this test is used on two-category data.</p></li>
</ol>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="section-13" class="section level2">
<h2>7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>In Example 7.2., the law school data set law in the bootstrap package is from Efron and Tibshirani. The data frame contains LSAT (average score on law school admission test score) and GPA (average undergraduate grade-point average) for 15 law schools.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">library</span>(bootstrap) <span class="co"># for the law data</span></span>
<span id="cb67-2"><a href="#cb67-2"></a></span>
<span id="cb67-3"><a href="#cb67-3"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, i) <span class="kw">cor</span>(x[i], y[i])</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="co"># set up the jackknife</span></span>
<span id="cb67-5"><a href="#cb67-5"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law) <span class="co"># sample size</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">b.cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA, <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb67-7"><a href="#cb67-7"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) <span class="co"># storage for replicates</span></span>
<span id="cb67-8"><a href="#cb67-8"></a></span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="co"># jackknife estimate of standard error of R</span></span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb67-11"><a href="#cb67-11"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">b.cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA, (<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb67-12"><a href="#cb67-12"></a>}</span>
<span id="cb67-13"><a href="#cb67-13"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb67-14"><a href="#cb67-14"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat, <span class="dt">bias.jack=</span>bias.jack, <span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.776    -0.006     0.143</code></pre>
</div>
<div id="section-14" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>Refer to Exercise 7.4, assume that the times between failures follow an exponential model Exp(<span class="math inline">\(\lambda\)</span>): <span class="math display">\[\begin{equation}
f(x;\lambda)=\lambda\exp(-\lambda x), x\geq 0
\end{equation}\]</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb69-2"><a href="#cb69-2"></a>lambda&lt;-<span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="fl">0.1</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a>interval.norm &lt;-<span class="st"> </span>interval.basic &lt;-<span class="st"> </span>interval.perc &lt;-<span class="st"> </span>interval.bca &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(lambda))</span>
<span id="cb69-4"><a href="#cb69-4"></a>m &lt;-<span class="st"> </span><span class="fl">1e2</span>; <span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb69-5"><a href="#cb69-5"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) <span class="kw">mean</span>(x[i])</span>
<span id="cb69-6"><a href="#cb69-6"></a>ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span>ci.bca &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="co"># R &lt;- aircondit$hours</span></span>
<span id="cb69-8"><a href="#cb69-8"></a>n &lt;-<span class="st"> </span><span class="fl">1e1</span></span>
<span id="cb69-9"><a href="#cb69-9"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lambda)){</span>
<span id="cb69-10"><a href="#cb69-10"></a>  mu &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>lambda[j]</span>
<span id="cb69-11"><a href="#cb69-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb69-12"><a href="#cb69-12"></a>    R &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda[j])</span>
<span id="cb69-13"><a href="#cb69-13"></a>    de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> R, <span class="dt">statistic =</span> boot.mean, <span class="dt">R =</span> <span class="dv">999</span>)</span>
<span id="cb69-14"><a href="#cb69-14"></a>    ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb69-15"><a href="#cb69-15"></a>    ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb69-16"><a href="#cb69-16"></a>    ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];ci.bca[i,]&lt;-ci<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb69-17"><a href="#cb69-17"></a>  }</span>
<span id="cb69-18"><a href="#cb69-18"></a>  interval.norm[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu)</span>
<span id="cb69-19"><a href="#cb69-19"></a>  interval.basic[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu)</span>
<span id="cb69-20"><a href="#cb69-20"></a>  interval.perc[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu)</span>
<span id="cb69-21"><a href="#cb69-21"></a>  interval.bca[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(ci.bca[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.bca[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu)</span>
<span id="cb69-22"><a href="#cb69-22"></a>}</span>
<span id="cb69-23"><a href="#cb69-23"></a><span class="kw">plot</span>(lambda, interval.norm, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.75</span>,<span class="fl">0.95</span>), <span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb69-24"><a href="#cb69-24"></a><span class="kw">lines</span>(lambda, interval.basic, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb69-25"><a href="#cb69-25"></a><span class="kw">lines</span>(lambda, interval.perc, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb69-26"><a href="#cb69-26"></a><span class="kw">lines</span>(lambda, interval.bca, <span class="dt">col=</span><span class="st">&#39;green&#39;</span>, <span class="dt">lty=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAAP8AOpAAZrYA/wA6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmADpmkJBmtrZmtv+QOgCQkGaQ2/+2ZgC225C2///bkDrb////AAD/tmb/25D//7b//9v///9mph5mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALf0lEQVR4nO2di1qkuBZGsWmpmXN05uixpqtTKu//lkMSArnBvxNIEa29vq+1q4QElsnOhaRsemaV5ugLqB0WBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQYAUQR/PT8PXa9M0P36Vup7qSBZ0+flb/u+l2BVVRqqgUY3SdBekCno/KUHXu6lkXIIAaYKG+Nw89iZc3wWJzfzg6OFtaMjuxg/3gxAsCJAm6PO1UdxNLyhR0Psfb0MDNrTw56VWvvkylBD0+api83n4en7cntyhFBFk9YGWOor3LciUoEddz7YmdyhFBPWXoQ+kAtHHs1vF0qv20ZQRpKY6HkI/uckdSCFBt06uHCwIUFoQB+nS+RakoxzEggAZgvRsz8YJ+W8s6POVMEloBquLEisQ1JEMpQuiPKi4mImyxRmzbyxoHEesYR2yNCddgSAaGTFIzWWsYhWyexysvp9QkP4SJajrSWE6p4otja9mLmYqseIY1E1fVikTpKeuwGKDd7ggUhvfFwrSe+ZbinKCCEF6z3xLMQhqe4KnnCrWfJOedCFB+1CDIEkBQd8jBikxlCJUqBWjJ3cQKgSVEbTPkp+jBUk/sWsIfN1xkI49Wel2ELQPBwuSHgZBQR0LR/h3K6gdrqAhBKEcQWq0+rCtt3isIBmiG9pF5ARpNQC9ZC1tqeTJaqfuR/gXoZo2r0Tl94O2Lc+sQJAQqorNRuR/Wr/O5feDtrX2R7diSo0IglAbHHifJUhFIFPH9ha0KQal51uCrm+EdRWd9TWoY1+lFaNO39ASE2K8ijkIdfM7mwXtQWJytEc0VISpSc1UpXTyevjxFQX1e5YhMYWauaEfBemiZWeVIQg+NU1L7vZ0U+bCBCGjRDf9GwUtLu1NIUXQrvGndwW1Tg6iEY3XkOX0g/abMJOD506yZmGa29rFlBj8zA6Eo6MdSpSIXiiB0hNm6Ob3MuQJcvMQ5p05oyIPDgl7VhNjUNiBy0SsNlLylde7zuoooiJE2LNKzte0vzshvKzdkNME75SZUSTsOIzN5sWOC8YBG2uZ8JVYr/T4w7uyIv0gwp5VoiD3vV3iUOMkYAehVszvTAcVE0QqQW6i4a2bd9r1wxaIHuj6ceeEtCA3COULWlrg25P2rDaRVBfv3ItAREPhBHyQ49wT0v8fv9qGSg010J7VxvuuINx5UrQO0xvv3n5net2O1c2tY4ePxVbSjfpKMRQV5L05ByFX0DS8p2ZWbLC6mPB0JxEnhLIWOyT0Y2c/leo2/vN10gSdhxCkBrVLXSadXCsvxZrAj9+3PEgI5yU21PndZElEkKVjrvaWoURBUydofTQv266zjNIoSPsvlu5b2IqotawN61MTZmAEtfFaX6QEqWnrq5pzxB1FWYpgr0h34dJKcRt7hhMJS+Zw4b/jXSggrR/0YrqIxI7i2tjVEtiI+CEh+sGOX9ZiNxF6ERuqmATv1UgqQZJ2Kt+d8039zDl4rGgoDnXjuGotU5PiWMeE9Y5lKGfC7Ofvy6MZSsSZYpC/2sp7smoVCFnThn9dG7l3p8xrRfqobppS8i5gXIHo9ZsjEag3PaHWysTOL2/C7DoIWH0uRmzF7EtprGcwK376eCzqglf6timC1IH9joJe+vc/f6l/+ZjknGsxjxTs0NFGWuuYIm8Vyziucgw1kZTmS3E7REHbD3GerH789baTIK/JaAJDUUHCLO5ZZhTUEAS1zgXpFxsE6c/keCI+ek7ds2oUzUTvSs57+dPrLq05bB6Xd3FBylDrCYIXGqYy//f8KFuybc82lvNt9EOHdv1Aea+yFLVjeJfvdVYT2JrDZovdklDhl1OxUdAeOMlFo7C+nXYpX+GmYt98N/9EWD9Z7BUo2b4g8AsKKSkorEYmCi/6iSYTfz/sWnnIdt7tSVhBKKcVw9uhkveshtFBK1qIGovpTGs07P6DWb2xlFgj2tb9mVXHcjqKeG1H+p7VaFveBovkwnOmI8ZfuQ5Ezg3rViraHI4J+T/bJqjXj7ya5YKUueNQSJzvYNzuGDLHqggk7GPGZny5NDbB5cxBKDsGfb6uzUnfaM+qF6nn1B1B4+7LWwoqU4IyiBuya8woKDp/Nl9MkARlSnjhDBV/YQy66Z5V0+SZ107N1IZAt9uXJzYIIrViN96z6hkKOlkdyC4oXHNPKG8stp39BIW1DA7242k4b2wQVN1+MW3ISrCNRhvYpXKPnmfwicwH1rZfzKxYncYnBwuqb7+YufVG1wt/VkM4B1HZUIJ2YdfkpptXpYgFraYbDinyBEUmGknHS4ZK9vP3eVtbtrcg78Hrws9SEswXdH14G/rHGxe77l6Cgr6e9aOs9LIFyX6QHECsrA9KSW4/VhTlpJYtSPaD1j7nNzG5/dmhkVdn6EvML0HnKveLiQUVNxQ0xqBa96zGKprIikPZgnRX8Svtes4TpPlu/aA4SxWPQEaQ/kuXnWqDdIS8hl59zRdUXTO/Ro6hPEHnOczW1VHcn60laBtfQJDmPoL0BjIEffk9q0nkPFmtbEaxLDljsbom7QtTZNJ+/y2Zx5EzWKXtWd1pS+bR5AxWSXtW07dk1kmRpxp5WzLrpEg/6L5LEAH6lsz6KdWTpm7JrJ5EQUOJqO/JalF4LAYoFIPghP69C/rvCYxH7l3QU39ZWcOYmNyhFBOkxmLLjliQ4rrY1rGghVTq+LDbBG4sKCu5Q+F+EIAFAUoL4j8jmpvvl+EgQRsSzTnpBuewoF0PJz5cvFtBeEtm1jXkn1SZIMKGuqxryD+pMkGELZlZ15B/UmWCuAQh8JbMrGvIP6k2QXhLZtY15J9UnaA7hAUBWBCABQFYEIAFAVgQgAUBWBCABQFYEIAFAVgQYE9BV2vL67zgE2J9euyVuml2PoeYkZpNn+ZoyPnsKkh+FPfV5Pv+B3X72cfzNDvppEA8h5bR5+uQ7LS2iZxPv6cgPd94NtdAXQtqLaVxU6CdQ8xIr38fnweT85HsJ8i5hv5Cy17OTU636KZAO4eckTpRlxpqPoodBamybq78/J+Guv11FuSkQDsnJSOzJS4hnz0F6V/P+EvSC2Jpn7UzXamTAvGcpIxGkQn5FBM0vkX6JW0SlJDR1Y7RBwiKFNzVP7Ewsa2KkTOan8QcVMUioY/WBCcH6T4UhDO6zIHqoCDtNJ76GhKrWELz60nFGdmfanNQM+92v1T2iUE6oQNntWKkjN6dLQLHdBTlb0l14PXuV/lhF7SPIlI3q0+6UIcA1jmkjC76gefDW2I+PFiFsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwLUI2jxM6q9xT/UVQc7wYIALAhQmaBxLcv76X/PTfP0fpKv3k9/n8aFrHLZyv+lIPrimq3UJUiuhroMAt5PamH8j19yoZx6oVZAyWW8V7myxxx3A6oSpP58jqxRSsf45UWvDlOmZKE5P7xNx92AqgTJb1ddq1766cu4DPHhTa+7G2PQ9UZ1rC5BQ4z58c/JF6SWsA5fL5Mgc9wNqErQ5AWUoPnH5alKkDJwDauYikE/f4/rm0dT+O+A7EJVgqSBj+fmyRek/s7Ai264ZCs2HXcDqhKkl+ee7TqkBP19GiOy6QeZ425wWfUIqhQWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgRgQQAWBGBBABYEYEEAFgT4F/tlPuEdWovkAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The black line shows the result of the standard normal, the red line shows the result of the basic, the blue line shows the result of the percentile, while the green line shows the result of the BCa methods. It demonstrates that the method based on BCa is better than others, since the result of BCa is a bias-corrected and accelerated CI.</p>
</div>
<div id="section-15" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>Refer to Exercise 7.7, I will discuss the scor (bootstrap) test score data on <span class="math inline">\(88\)</span> students who took examinations in five subjects.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="kw">print</span>(<span class="kw">names</span>(scor))</span></code></pre></div>
<pre><code>## [1] &quot;mec&quot; &quot;vec&quot; &quot;alg&quot; &quot;ana&quot; &quot;sta&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>n &lt;-<span class="st"> </span><span class="dv">88</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>X&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, n, <span class="dv">5</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a>X[,<span class="dv">1</span>] &lt;-<span class="st"> </span>scor<span class="op">$</span>mec</span>
<span id="cb72-4"><a href="#cb72-4"></a>X[,<span class="dv">2</span>] &lt;-<span class="st"> </span>scor<span class="op">$</span>vec</span>
<span id="cb72-5"><a href="#cb72-5"></a>X[,<span class="dv">3</span>] &lt;-<span class="st"> </span>scor<span class="op">$</span>alg</span>
<span id="cb72-6"><a href="#cb72-6"></a>X[,<span class="dv">4</span>] &lt;-<span class="st"> </span>scor<span class="op">$</span>ana</span>
<span id="cb72-7"><a href="#cb72-7"></a>X[,<span class="dv">5</span>] &lt;-<span class="st"> </span>scor<span class="op">$</span>sta</span>
<span id="cb72-8"><a href="#cb72-8"></a>Cov_X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb72-9"><a href="#cb72-9"></a></span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="co"># calculate theta.hat</span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb72-12"><a href="#cb72-12"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb72-13"><a href="#cb72-13"></a>    Cov_X[i,j] =<span class="st"> </span><span class="kw">cov</span>(X[,i], X[,j])</span>
<span id="cb72-14"><a href="#cb72-14"></a>  }</span>
<span id="cb72-15"><a href="#cb72-15"></a>}</span>
<span id="cb72-16"><a href="#cb72-16"></a>eigen_value &lt;-<span class="st"> </span><span class="kw">eigen</span>(Cov_X)<span class="op">$</span>val</span>
<span id="cb72-17"><a href="#cb72-17"></a>theta.hat &lt;-<span class="st"> </span>eigen_value[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigen_value)</span>
<span id="cb72-18"><a href="#cb72-18"></a></span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="co"># calculate theta.jack</span></span>
<span id="cb72-20"><a href="#cb72-20"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb72-21"><a href="#cb72-21"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb72-22"><a href="#cb72-22"></a>  New_X &lt;-<span class="st"> </span>X[<span class="op">-</span>k,]</span>
<span id="cb72-23"><a href="#cb72-23"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb72-24"><a href="#cb72-24"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb72-25"><a href="#cb72-25"></a>      Cov_X[i,j] =<span class="st"> </span><span class="kw">cov</span>(New_X[,i], New_X[,j])</span>
<span id="cb72-26"><a href="#cb72-26"></a>    }</span>
<span id="cb72-27"><a href="#cb72-27"></a>  }</span>
<span id="cb72-28"><a href="#cb72-28"></a>  eigen_value &lt;-<span class="st"> </span><span class="kw">eigen</span>(Cov_X)<span class="op">$</span>val</span>
<span id="cb72-29"><a href="#cb72-29"></a>  theta.jack[k] &lt;-<span class="st"> </span>eigen_value[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigen_value)</span>
<span id="cb72-30"><a href="#cb72-30"></a>}</span>
<span id="cb72-31"><a href="#cb72-31"></a></span>
<span id="cb72-32"><a href="#cb72-32"></a><span class="co"># calculate the jackknife estimates of bias and standard error of theta_hat</span></span>
<span id="cb72-33"><a href="#cb72-33"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb72-34"><a href="#cb72-34"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb72-35"><a href="#cb72-35"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p>The results show that the bias of the jackknife estimates is <span class="math inline">\(0.001\)</span>, while the standard error of it is <span class="math inline">\(0.050\)</span>.</p>
</div>
<div id="section-16" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>Refer to Example 7.18, we can fit models on leave-one-out samples as:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">library</span>(DAAG)</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb74-3"><a href="#cb74-3"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb74-5"><a href="#cb74-5"></a></span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb74-9"><a href="#cb74-9"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</span>
<span id="cb74-10"><a href="#cb74-10"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb74-11"><a href="#cb74-11"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb74-12"><a href="#cb74-12"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb74-13"><a href="#cb74-13"></a>  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb74-14"><a href="#cb74-14"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb74-15"><a href="#cb74-15"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb74-16"><a href="#cb74-16"></a><span class="st">  </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb74-17"><a href="#cb74-17"></a>  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb74-18"><a href="#cb74-18"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb74-19"><a href="#cb74-19"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb74-20"><a href="#cb74-20"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb74-21"><a href="#cb74-21"></a>  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb74-22"><a href="#cb74-22"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb74-23"><a href="#cb74-23"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb74-24"><a href="#cb74-24"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb74-25"><a href="#cb74-25"></a>  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb74-26"><a href="#cb74-26"></a>}</span>
<span id="cb74-27"><a href="#cb74-27"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 20.45424</code></pre>
<p>Then, we can fit models with leave-two-out cross validation as:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">library</span>(DAAG)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb76-3"><a href="#cb76-3"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>))</span>
<span id="cb76-5"><a href="#cb76-5"></a></span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb76-9"><a href="#cb76-9"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</span>
<span id="cb76-10"><a href="#cb76-10"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb76-11"><a href="#cb76-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb76-12"><a href="#cb76-12"></a>    x &lt;-<span class="st"> </span>x[<span class="op">-</span>j]</span>
<span id="cb76-13"><a href="#cb76-13"></a>    y &lt;-<span class="st"> </span>y[<span class="op">-</span>j]</span>
<span id="cb76-14"><a href="#cb76-14"></a>    index &lt;-<span class="st"> </span>(k<span class="dv">-1</span>)<span class="op">*</span>(n<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>j</span>
<span id="cb76-15"><a href="#cb76-15"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb76-16"><a href="#cb76-16"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb76-17"><a href="#cb76-17"></a>    e1[index] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb76-18"><a href="#cb76-18"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb76-19"><a href="#cb76-19"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb76-20"><a href="#cb76-20"></a><span class="st">    </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-21"><a href="#cb76-21"></a>    e2[index] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb76-22"><a href="#cb76-22"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb76-23"><a href="#cb76-23"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb76-24"><a href="#cb76-24"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb76-25"><a href="#cb76-25"></a>    e3[index] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb76-26"><a href="#cb76-26"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb76-27"><a href="#cb76-27"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb76-28"><a href="#cb76-28"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb76-29"><a href="#cb76-29"></a>    e4[index] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb76-30"><a href="#cb76-30"></a>  }</span>
<span id="cb76-31"><a href="#cb76-31"></a>}</span>
<span id="cb76-32"><a href="#cb76-32"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 19.16146 17.66247 17.56625 19.69132</code></pre>
<p>The results show that: according to the prediction error criterion of leave-one-out samples, the quadratic model would be the best fit for the data; while according to the prediction error criterion of leave-two-out cross validation, the exp model would be the best fit for the data.</p>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="section-17" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>As Section 6.4 shown, the computation of the test statistic is illustrated with a numerical example. Compare the side-by-side boxplots in Figure 6.4 and observe that there are some extreme points in each sample with respect to the other sample. However, Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. As below shows:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb78-2"><a href="#cb78-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb78-3"><a href="#cb78-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb78-4"><a href="#cb78-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb78-5"><a href="#cb78-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb78-6"><a href="#cb78-6"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb78-7"><a href="#cb78-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb78-8"><a href="#cb78-8"></a>}</span>
<span id="cb78-9"><a href="#cb78-9"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb78-10"><a href="#cb78-10"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb78-11"><a href="#cb78-11"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb78-12"><a href="#cb78-12"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb78-13"><a href="#cb78-13"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb78-14"><a href="#cb78-14"></a>alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb78-15"><a href="#cb78-15"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb78-16"><a href="#cb78-16"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb78-17"><a href="#cb78-17"></a>  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb78-18"><a href="#cb78-18"></a>  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb78-19"><a href="#cb78-19"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb78-20"><a href="#cb78-20"></a>  }))</span>
<span id="cb78-21"><a href="#cb78-21"></a><span class="kw">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.1117</code></pre>
<p>The simulation result suggests that the “Count Five” criterion does not necessarily control Type I error. So we must come up with a method to handle it, for example, we can implement a permutation test for equal variance based on the maximum number of extreme points, like:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb80-4"><a href="#cb80-4"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb80-5"><a href="#cb80-5"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb80-7"><a href="#cb80-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb80-8"><a href="#cb80-8"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb80-9"><a href="#cb80-9"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(n2, <span class="dt">size=</span>n2<span class="op">-</span>n1, <span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb80-10"><a href="#cb80-10"></a>  y &lt;-<span class="st"> </span>y[<span class="op">-</span>k]</span>
<span id="cb80-11"><a href="#cb80-11"></a>  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb80-12"><a href="#cb80-12"></a>  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb80-13"><a href="#cb80-13"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb80-14"><a href="#cb80-14"></a>  }))</span>
<span id="cb80-15"><a href="#cb80-15"></a><span class="kw">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.0533</code></pre>
<p>It shows that the simulation result suggests that the “Count Five” criterion control Type I error.</p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations;</p></li>
<li><p>Unequal variances and unequal expectations;</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions);</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls).</p></li>
</ol>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>Firstly, we need to implement some methods, as:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="co"># illustration of NN test</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb82-7"><a href="#cb82-7"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb82-8"><a href="#cb82-8"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb82-9"><a href="#cb82-9"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb82-10"><a href="#cb82-10"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb82-12"><a href="#cb82-12"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb82-13"><a href="#cb82-13"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb82-14"><a href="#cb82-14"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb82-15"><a href="#cb82-15"></a>}</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Unequal variances and equal expectations</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb83-3"><a href="#cb83-3"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb83-4"><a href="#cb83-4"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb83-5"><a href="#cb83-5"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb83-6"><a href="#cb83-6"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb83-7"><a href="#cb83-7"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb83-8"><a href="#cb83-8"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</span>
<span id="cb83-9"><a href="#cb83-9"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb83-10"><a href="#cb83-10"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb83-11"><a href="#cb83-11"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb83-12"><a href="#cb83-12"></a>p1.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb83-13"><a href="#cb83-13"></a><span class="kw">print</span>(p1.value) <span class="co"># NN test</span></span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>p2.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="kw">print</span>(p2.value) <span class="co"># energy test</span></span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>p3.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw">print</span>(p3.value<span class="op">$</span>p.value) <span class="co"># Ball test</span></span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.01</code></pre>
<p>It shows that the p-value for testing homogeneous distribution based on NN, energy and Ball are <span class="math inline">\(0.001, 0.001, 0.01\)</span> respectively.</p>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>mu1 &lt;-<span class="st"> </span><span class="dv">-1</span>; mu2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb89-4"><a href="#cb89-4"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb89-6"><a href="#cb89-6"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb89-7"><a href="#cb89-7"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb89-8"><a href="#cb89-8"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</span>
<span id="cb89-9"><a href="#cb89-9"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb89-10"><a href="#cb89-10"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb89-11"><a href="#cb89-11"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb89-12"><a href="#cb89-12"></a>p1.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="kw">print</span>(p1.value) <span class="co"># NN test</span></span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a>p2.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="kw">print</span>(p2.value) <span class="co"># energy test</span></span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>p3.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="kw">print</span>(p3.value<span class="op">$</span>p.value) <span class="co"># Ball test</span></span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.01</code></pre>
<p>It shows that the p-value for testing distribution based on NN, energy and Ball are <span class="math inline">\(0.001, 0.001, 0.01\)</span> respectively.</p>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb95-4"><a href="#cb95-4"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(<span class="dt">n=</span>n1<span class="op">*</span><span class="dv">2</span>, <span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb95-5"><a href="#cb95-5"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb95-6"><a href="#cb95-6"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</span>
<span id="cb95-7"><a href="#cb95-7"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb95-8"><a href="#cb95-8"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb95-9"><a href="#cb95-9"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb95-10"><a href="#cb95-10"></a>p1.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb95-11"><a href="#cb95-11"></a><span class="kw">print</span>(p1.value) <span class="co"># NN test</span></span></code></pre></div>
<pre><code>## [1] 0.986</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb97-2"><a href="#cb97-2"></a>p2.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="kw">print</span>(p2.value) <span class="co"># energy test</span></span></code></pre></div>
<pre><code>## [1] 0.809</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>p3.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="kw">print</span>(p3.value<span class="op">$</span>p.value) <span class="co"># Ball test</span></span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.88</code></pre>
<p>It shows that the p-value for testing distribution based on NN, energy and Ball are <span class="math inline">\(0.986, 0.809, 0.88\)</span> respectively.</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb101-2"><a href="#cb101-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb101-4"><a href="#cb101-4"></a>mu1 &lt;-<span class="st"> </span><span class="dv">0</span>; mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb101-5"><a href="#cb101-5"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb101-7"><a href="#cb101-7"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb101-8"><a href="#cb101-8"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb101-9"><a href="#cb101-9"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</span>
<span id="cb101-10"><a href="#cb101-10"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb101-11"><a href="#cb101-11"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb101-12"><a href="#cb101-12"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb101-13"><a href="#cb101-13"></a>p1.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb101-14"><a href="#cb101-14"></a><span class="kw">print</span>(p1.value) <span class="co"># NN test</span></span></code></pre></div>
<pre><code>## [1] 0.348</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb103-2"><a href="#cb103-2"></a>p2.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="kw">print</span>(p2.value) <span class="co"># energy test</span></span></code></pre></div>
<pre><code>## [1] 0.155</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>p3.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="kw">print</span>(p3.value<span class="op">$</span>p.value) <span class="co"># Ball test</span></span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.14</code></pre>
<p>It shows that the p-value for testing distribution based on NN, energy and Ball are <span class="math inline">\(0.348, 0.155, 0.14\)</span> respectively.</p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="section-18" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>Refer to Exercise 3.2, the standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in \mathbb{R}\)</span>. The Metropolis-Hastings algorithms are a class of Markov Chain Monte Carlo methods including the special cases of the Metropolis sampler. In the Metropolis algorithm, the proposal distribution is symmetric. That is, the proposal distribution <span class="math inline">\(g(\cdot|X_t)\)</span> satisfies <span class="math display">\[\begin{equation}
g(X|Y)=g(Y|X),
\end{equation}\]</span> The cdf of <span class="math inline">\(f(x)\)</span> is proportional to <span class="math inline">\(\frac{1}{2}e^{-|x|}\)</span>, so <span class="math display">\[\begin{equation}
r(x_t,y)=\frac{f(Y)}{f(X_t)}=\frac{\frac{1}{2}e^{-|y|}}{\frac{1}{2}e^{-|x_t|}},
\end{equation}\]</span> So given the parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(\sigma\)</span>, initial value <span class="math inline">\(X_0\)</span>, and the length of the chain, <span class="math inline">\(N\)</span>, we can generate the chain as below:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">library</span>(LaplacesDemon)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;LaplacesDemon&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(m, s, sigma, x0, N)</span>
<span id="cb110-2"><a href="#cb110-2"></a>{</span>
<span id="cb110-3"><a href="#cb110-3"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb110-4"><a href="#cb110-4"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb110-5"><a href="#cb110-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb110-6"><a href="#cb110-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb110-7"><a href="#cb110-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N)</span>
<span id="cb110-8"><a href="#cb110-8"></a>  {</span>
<span id="cb110-9"><a href="#cb110-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb110-10"><a href="#cb110-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dlaplace</span>(y, m, s) <span class="op">/</span><span class="st"> </span><span class="kw">dlaplace</span>(x[i<span class="dv">-1</span>], m, s)))</span>
<span id="cb110-11"><a href="#cb110-11"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb110-12"><a href="#cb110-12"></a>    <span class="cf">else</span></span>
<span id="cb110-13"><a href="#cb110-13"></a>    {</span>
<span id="cb110-14"><a href="#cb110-14"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb110-15"><a href="#cb110-15"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-16"><a href="#cb110-16"></a>    }</span>
<span id="cb110-17"><a href="#cb110-17"></a>  }</span>
<span id="cb110-18"><a href="#cb110-18"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb110-19"><a href="#cb110-19"></a>}</span></code></pre></div>
<p>Then, six chains are generated for different variances <span class="math inline">\(\sigma^2\)</span> of the proposal distribution.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>m &lt;-<span class="st"> </span><span class="dv">0</span>; s &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb111-2"><a href="#cb111-2"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb111-3"><a href="#cb111-3"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">005</span>, <span class="fl">.05</span>, <span class="fl">.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb111-4"><a href="#cb111-4"></a>x0 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb111-5"><a href="#cb111-5"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb111-6"><a href="#cb111-6"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb111-7"><a href="#cb111-7"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb111-8"><a href="#cb111-8"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb111-9"><a href="#cb111-9"></a>rw5 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">5</span>], x0, N)</span>
<span id="cb111-10"><a href="#cb111-10"></a>rw6 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(m, s, sigma[<span class="dv">6</span>], x0, N)</span>
<span id="cb111-11"><a href="#cb111-11"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb111-12"><a href="#cb111-12"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k, rw5<span class="op">$</span>k, rw6<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1]   2  16 151 316 699 850</code></pre>
<p>We can find that only the third chain has a rejection rate in the range <span class="math inline">\([0.15, 0.5]\)</span>.</p>
<p>The plots below show that the random walk Metropolis sampler is very sensitive to the variance of the proposal distribution.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co">#display 6 graphs together</span></span>
<span id="cb113-2"><a href="#cb113-2"></a>refline &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">location=</span>m, <span class="dt">scale=</span>s)</span>
<span id="cb113-3"><a href="#cb113-3"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x, rw5<span class="op">$</span>x, rw6<span class="op">$</span>x)</span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb113-5"><a href="#cb113-5"></a>{</span>
<span id="cb113-6"><a href="#cb113-6"></a>  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb113-7"><a href="#cb113-7"></a>    <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb113-8"><a href="#cb113-8"></a>    <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb113-9"><a href="#cb113-9"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb113-10"><a href="#cb113-10"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></span></code></pre></div>
<p>Usually in MCMC problems one does not have the theoretical quantiles of the target distribution available for comparison, but in this case the output of the random walk Metropolis chains in Example 9.3 can be compared with the theoretical quantiles of the target distribution. Discard the burn-in values in the first 500 rows of each chain. The quantiles are computed by the apply function (applying quantile to the columns of the matrix). The quantiles of the target distribution and the sample quantiles of the six chains rw1, rw2, rw3, and rw4 are in the table below.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="kw">library</span>(xtable)</span>
<span id="cb115-2"><a href="#cb115-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb115-3"><a href="#cb115-3"></a>Q &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(a, m, s)</span>
<span id="cb115-4"><a href="#cb115-4"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x, rw5<span class="op">$</span>x, rw6<span class="op">$</span>x)</span>
<span id="cb115-5"><a href="#cb115-5"></a>mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N, ]</span>
<span id="cb115-6"><a href="#cb115-6"></a>Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</span>
<span id="cb115-7"><a href="#cb115-7"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##          Q                                         
## 5%  -2.303 0.072 -0.190 -1.775 -1.925 -2.447 -1.280
## 10% -1.609 0.085 -0.140 -1.267 -1.518 -1.460 -1.073
## 20% -0.916 0.111 -0.008 -0.755 -0.993 -0.946 -0.726
## 30% -0.511 0.120  0.178 -0.366 -0.619 -0.482 -0.075
## 40% -0.223 0.128  0.521 -0.158 -0.378 -0.111  0.209
## 50%  0.000 0.139  0.655 -0.001 -0.114 -0.046  0.368
## 60%  0.223 0.149  0.829  0.200  0.051  0.169  0.433
## 70%  0.511 0.168  1.301  0.418  0.228  0.351  0.538
## 80%  0.916 0.187  1.445  0.811  0.510  0.855  0.759
## 90%  1.609 0.209  1.618  1.211  0.967  1.421  1.903
## 95%  2.303 0.222  1.701  1.472  1.215  2.266  3.053</code></pre>
</div>
<div id="extension-9.4" class="section level2">
<h2>Extension 9.4</h2>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<p>This example illustrates the Gelman-Rubin method of monitoring convergence of a Metropolis chain. The target distribution is the standard Laplace distribution, and the proposal distribution is <span class="math inline">\(N(X_t, \sigma^2)\)</span>. After generating all chains the diagnostic statistics are computed in the Gelman.Rubin function below:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi)</span>
<span id="cb117-2"><a href="#cb117-2"></a>{</span>
<span id="cb117-3"><a href="#cb117-3"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb117-4"><a href="#cb117-4"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb117-5"><a href="#cb117-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb117-6"><a href="#cb117-6"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb117-7"><a href="#cb117-7"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb117-8"><a href="#cb117-8"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)</span>
<span id="cb117-9"><a href="#cb117-9"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</span>
<span id="cb117-10"><a href="#cb117-10"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb117-11"><a href="#cb117-11"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</span>
<span id="cb117-12"><a href="#cb117-12"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)</span>
<span id="cb117-13"><a href="#cb117-13"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co"># G-R statistic</span></span>
<span id="cb117-14"><a href="#cb117-14"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb117-15"><a href="#cb117-15"></a>}</span></code></pre></div>
<p>Since several chains are to be generated, the M-H sampler is written as a function laplace.chain, as below:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="kw">library</span>(LaplacesDemon)</span>
<span id="cb118-2"><a href="#cb118-2"></a>laplace.chain &lt;-<span class="st"> </span><span class="cf">function</span>(scale, sigma, N, X1)</span>
<span id="cb118-3"><a href="#cb118-3"></a>{</span>
<span id="cb118-4"><a href="#cb118-4"></a>  <span class="co"># generates a Metropolis chain for the standard Laplace distribution</span></span>
<span id="cb118-5"><a href="#cb118-5"></a>  <span class="co"># with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb118-6"><a href="#cb118-6"></a>  <span class="co"># and starting value X1</span></span>
<span id="cb118-7"><a href="#cb118-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb118-8"><a href="#cb118-8"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb118-9"><a href="#cb118-9"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb118-10"><a href="#cb118-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N)</span>
<span id="cb118-11"><a href="#cb118-11"></a>  {</span>
<span id="cb118-12"><a href="#cb118-12"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb118-13"><a href="#cb118-13"></a>    y &lt;-<span class="st"> </span><span class="kw">rlaplace</span>(<span class="dv">1</span>, xt, scale) <span class="co"># Laplace distribution</span></span>
<span id="cb118-14"><a href="#cb118-14"></a>    r1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(y, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb118-15"><a href="#cb118-15"></a>    r2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(xt, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb118-16"><a href="#cb118-16"></a>    r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb118-17"><a href="#cb118-17"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r)</span>
<span id="cb118-18"><a href="#cb118-18"></a>    {</span>
<span id="cb118-19"><a href="#cb118-19"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb118-20"><a href="#cb118-20"></a>    }</span>
<span id="cb118-21"><a href="#cb118-21"></a>    <span class="cf">else</span></span>
<span id="cb118-22"><a href="#cb118-22"></a>    {</span>
<span id="cb118-23"><a href="#cb118-23"></a>      x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb118-24"><a href="#cb118-24"></a>    }</span>
<span id="cb118-25"><a href="#cb118-25"></a>  }</span>
<span id="cb118-26"><a href="#cb118-26"></a>  <span class="kw">return</span>(x)</span>
<span id="cb118-27"><a href="#cb118-27"></a>}</span>
<span id="cb118-28"><a href="#cb118-28"></a></span>
<span id="cb118-29"><a href="#cb118-29"></a>scale &lt;-<span class="st"> </span><span class="fl">1.</span></span>
<span id="cb118-30"><a href="#cb118-30"></a>sigma &lt;-<span class="st"> </span><span class="fl">.5</span></span>
<span id="cb118-31"><a href="#cb118-31"></a>k &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb118-32"><a href="#cb118-32"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb118-33"><a href="#cb118-33"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb118-34"><a href="#cb118-34"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb118-35"><a href="#cb118-35"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb118-36"><a href="#cb118-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb118-37"><a href="#cb118-37"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">laplace.chain</span>(scale, sigma, n, x0[i])</span>
<span id="cb118-38"><a href="#cb118-38"></a></span>
<span id="cb118-39"><a href="#cb118-39"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb118-40"><a href="#cb118-40"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb118-41"><a href="#cb118-41"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb118-42"><a href="#cb118-42"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.062776</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb120-3"><a href="#cb120-3"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb120-4"><a href="#cb120-4"></a>    <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb121-2"><a href="#cb121-2"></a></span>
<span id="cb121-3"><a href="#cb121-3"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb121-5"><a href="#cb121-5"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb121-6"><a href="#cb121-6"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb121-7"><a href="#cb121-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-19" class="section level2">
<h2>11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[\begin{equation}
S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})
\end{equation}\]</span> and <span class="math display">\[\begin{equation}
S_k(a)=P(t(k)&gt;\sqrt{\frac{a^2 k}{k+1-a^2}}),
\end{equation}\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors.)</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>Firstly, we define a function <span class="math inline">\(f_{k}(a)\)</span> as below: <span class="math display">\[\begin{equation}
f_k(a)=S_k(a)-S_{k-1}(a)
\end{equation}\]</span> Then we only need to find the root of the function <span class="math inline">\(f_k(a)\)</span>. We define the <span class="math inline">\(f_k(a)\)</span> as below:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) {</span>
<span id="cb122-2"><a href="#cb122-2"></a>  x1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>a))</span>
<span id="cb122-3"><a href="#cb122-3"></a>  x2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">*</span>a))</span>
<span id="cb122-4"><a href="#cb122-4"></a>  </span>
<span id="cb122-5"><a href="#cb122-5"></a>  <span class="kw">return</span> (<span class="kw">pt</span>(x1, <span class="dv">1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(x2, <span class="dv">1</span>))</span>
<span id="cb122-6"><a href="#cb122-6"></a>}</span></code></pre></div>
<p>Then use “uniroot” to find the root of it, as below:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>k_vals &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="cf">for</span> (k <span class="cf">in</span> k_vals){</span>
<span id="cb123-3"><a href="#cb123-3"></a>  res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="kw">c</span>(<span class="fl">0.001</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.001</span>), k)</span>
<span id="cb123-4"><a href="#cb123-4"></a>  <span class="kw">print</span>(<span class="kw">unlist</span>(res)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb123-5"><a href="#cb123-5"></a>}</span></code></pre></div>
<pre><code>##         root       f.root         iter 
## 9.999802e-01 2.632495e-07 5.000000e+00 
##         root       f.root         iter 
## 9.999989e-01 8.454219e-09 9.000000e+00 
##          root        f.root          iter 
##  1.000030e+00 -1.610557e-07  9.000000e+00 
##         root       f.root         iter 
## 9.999924e-01 2.898590e-08 8.000000e+00 
##          root        f.root          iter 
##  1.000001e+00 -3.963323e-09  9.000000e+00 
##          root        f.root          iter 
##  1.000010e+00 -2.133928e-08  9.000000e+00 
##          root        f.root          iter 
##  1.000023e+00 -4.066310e-08  9.000000e+00 
##         root       f.root         iter 
## 9.999721e-01 4.038723e-08 9.000000e+00 
##         root       f.root         iter 
## 9.999843e-01 1.888338e-08 9.000000e+00 
##         root       f.root         iter 
## 9.999933e-01 6.802934e-09 9.000000e+00 
##         root       f.root         iter 
## 9.999981e-01 1.647305e-09 9.000000e+00 
##         root       f.root         iter 
## 9.999958e-01 3.185255e-09 8.000000e+00 
##         root       f.root         iter 
## 9.999995e-01 3.012106e-10 8.000000e+00 
##         root       f.root         iter 
##  1.00000e+00 -1.44468e-10  1.00000e+01 
##          root        f.root          iter 
##  1.000003e+00 -1.501113e-09  1.000000e+01 
##          root        f.root          iter 
##  1.000010e+00 -4.849561e-09  1.000000e+01 
##          root        f.root          iter 
##  1.000024e+00 -9.853716e-09  1.000000e+01 
##         root       f.root         iter 
## 9.999803e-01 7.473499e-09 1.000000e+01 
##         root       f.root         iter 
## 9.999998e-01 7.287027e-11 1.000000e+01 
##         root       f.root         iter 
## 9.999997e-01 1.043527e-10 1.000000e+01 
##         root       f.root         iter 
## 9.999995e-01 1.342164e-10 1.000000e+01 
##         root       f.root         iter 
## 9.999979e-01 5.687022e-10 1.100000e+01 
##         root       f.root         iter 
## 9.999990e-01 1.647527e-11 1.300000e+01 
##          root        f.root          iter 
##  1.000000e+00 -1.716405e-13  1.500000e+01 
##         root       f.root         iter 
## 9.999999e-01 1.709743e-14 1.400000e+01</code></pre>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>A-B-O blood type problem: Observed that: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=444\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132\)</span> (B-type), <span class="math inline">\(n_{OO}=361\)</span> (O-type), <span class="math inline">\(n_{AB}=63\)</span> (AB-type). Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>(consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>). Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<p>If the genotype data at the ABO gene were observed, then the likelihood function would have the following multinomial distribution <span class="math display">\[\begin{equation}
f(X|\theta)=\left[
 \begin{matrix}
   n \\
   n_{A\cdot},n_{B\cdot},n_{AB},n_{OO}
  \end{matrix}
  \right]\times(p^2)^{n_{AA}}(2pr)^{n_{AO}}(q^2)^{n_{BB}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}(r^2)^{n_{OO}}
\end{equation}\]</span></p>
<p>The complete data log-likelihood function is <span class="math display">\[\begin{equation}
\ln(f(X|\theta))=\ln\left[
 \begin{matrix}
   n \\
   n_{A\cdot},n_{B\cdot},n_{AB},n_{OO}
 \end{matrix}
 \right]+ \\
 n_{AA}\ln(p^2)+n_{AO}\ln(2pr)+n_{BB}\ln(q^2)+n_{BO}\ln(2qr)+n_{AB}\ln(2pq)+n_{OO}\ln(r^2)
\end{equation}\]</span></p>
<p>Then we can obtain the maximum likelihood estimate of <span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>, and <span class="math inline">\(r\)</span> by taking the derivatives of the function with respect to the three parameters and solving for 0. The MLE is: <span class="math display">\[\begin{equation}
\hat{p}=\frac{2n_{AA}+n_{AO}+n_{AB}}{2n} \\
\hat{q}=\frac{2n_{BB}+n_{BO}+n_{AB}}{2n} \\
\hat{r}=\frac{2n_O+n_{AO}+n_{BO}}{2n}
\end{equation}\]</span></p>
<p>Remember that the observed data is <span class="math inline">\(Y=(n_A,n_B,n_{AB},n_O)\)</span>, so for the initial iteration of the EM algorithm, the E step calculates <span class="math inline">\(Q(\theta|\theta^0)=E[\ln(f(X|\theta))|Y,\theta^0]\)</span>. Then the EM algorithm can be described by:</p>
<ol style="list-style-type: decimal">
<li><p>Start with initial estimates <span class="math inline">\((p^0,q^0,r^0)\)</span></p></li>
<li><p>Calculate the expected <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>, given observed data and <span class="math inline">\(p^k\)</span> as <span class="math display">\[\begin{equation}
n^{k+1}_{AA}=E(n_{AA}|n_{A\cdot},p^k)=n_{A\cdot}\frac{p^k p^k}{p^k p^k+2r^k p^k},
n^{k+1}_{BB}=E(n_{BB}|n_{B\cdot},q^k)=n_{B\cdot}\frac{q^k q^k}{q^k q^k+2r^k q^k},
\end{equation}\]</span></p></li>
<li><p>Update <span class="math inline">\(p^{k+1}\)</span>. Imaging that <span class="math inline">\(n^{k+1}_{AA}\)</span>, <span class="math inline">\(n^{k+1}_{BB}\)</span> and <span class="math inline">\(n^{k+1}_{AB}\)</span> were actually observed <span class="math display">\[\begin{equation}
p^{k+1}=(2n_{AA}^{k+1}+n_{AO}^{k+1}+n_{AB}^{k+1})/(2n), \\
q^{k+1}=(2n_{BB}^{k+1}+n_{BO}^{k+1}+n_{AB}^{k+1})/(2n), \\
r^{k+1}=(2n_O+n_{AO}^{k+1}+n_{BO}^{k+1})/(2n),
\end{equation}\]</span></p></li>
</ol>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>p=<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>; q=<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>; r=<span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>x=<span class="dv">0</span>; y=<span class="dv">0</span></span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb125-4"><a href="#cb125-4"></a>  x=<span class="dv">444</span><span class="op">*</span>p<span class="op">*</span>p<span class="op">/</span>(p<span class="op">*</span>p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r<span class="op">*</span>p)</span>
<span id="cb125-5"><a href="#cb125-5"></a>  y=<span class="dv">132</span><span class="op">*</span>q<span class="op">*</span>q<span class="op">/</span>(q<span class="op">*</span>q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r<span class="op">*</span>q)</span>
<span id="cb125-6"><a href="#cb125-6"></a>  p=(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span>(<span class="dv">444</span><span class="op">-</span>x)<span class="op">+</span><span class="dv">63</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1000</span>)</span>
<span id="cb125-7"><a href="#cb125-7"></a>  q=(<span class="dv">2</span><span class="op">*</span>y<span class="op">+</span>(<span class="dv">132</span><span class="op">-</span>y)<span class="op">+</span><span class="dv">63</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1000</span>)</span>
<span id="cb125-8"><a href="#cb125-8"></a>  r=(<span class="dv">2</span><span class="op">*</span><span class="dv">361</span><span class="op">+</span>(<span class="dv">444</span><span class="op">-</span>x)<span class="op">+</span>(<span class="dv">132</span><span class="op">-</span>y))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1000</span>)</span>
<span id="cb125-9"><a href="#cb125-9"></a>  lnf=<span class="op">-</span>(<span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(p<span class="op">*</span>p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span><span class="dv">132</span><span class="op">*</span>(q<span class="op">*</span>q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span><span class="dv">361</span><span class="op">*</span>r<span class="op">+</span><span class="dv">63</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</span>
<span id="cb125-10"><a href="#cb125-10"></a>  <span class="kw">print</span>(<span class="kw">c</span>(p,q,r, lnf))</span>
<span id="cb125-11"><a href="#cb125-11"></a>}</span></code></pre></div>
<pre><code>## [1]  0.32750  0.11950  0.55300 77.62899
## [1]  0.3042185  0.1039357  0.5918457 80.8855783
## [1]  0.2988902  0.1028274  0.5982824 83.6553561
## [1]  0.2978702  0.1027229  0.5994069 84.2647704
## [1]  0.2976825  0.1027090  0.5996085 84.3805240
## [1]  0.2976483  0.1027067  0.5996450 84.4017840
## [1]  0.2976420  0.1027063  0.5996516 84.4056551
## [1]  0.2976409  0.1027063  0.5996528 84.4063584
## [1]  0.2976407  0.1027063  0.5996530 84.4064861
## [1]  0.2976407  0.1027063  0.5996531 84.4065092</code></pre>
<p>It shows that in each EM steps, the corresponding log-maximum likelihood values (for observed data), are increasing.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Use both <code>for</code> loops and <code>lapply()</code> to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># the formulas</span></span>
<span id="cb127-2"><a href="#cb127-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb127-3"><a href="#cb127-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb127-4"><a href="#cb127-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb127-5"><a href="#cb127-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb127-6"><a href="#cb127-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb127-7"><a href="#cb127-7"></a>)</span></code></pre></div>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>We use both <code>for</code> loops and <code>lapply()</code> to fit linear models to the mtcars using the formulas stored in the list, as:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="co"># use lapply()</span></span>
<span id="cb128-2"><a href="#cb128-2"></a><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># use for loops</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>formulas_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;list&#39;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</span>
<span id="cb130-4"><a href="#cb130-4"></a>    formulas_<span class="dv">2</span>[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</span>
<span id="cb130-5"><a href="#cb130-5"></a>}</span>
<span id="cb130-6"><a href="#cb130-6"></a>formulas_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use <code>sapply()</code> and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb132-2"><a href="#cb132-2"></a>  <span class="dv">100</span>,</span>
<span id="cb132-3"><a href="#cb132-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb132-4"><a href="#cb132-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb132-5"><a href="#cb132-5"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using <code>[[</code> directly.</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<p>We use <code>sapply()</code> and an anonymous function to extract the p-value from every trial:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># use sapply() and an anonymous function to extract the p-value from every trial</span></span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value) <span class="co"># function(x): an anonymous function</span></span></code></pre></div>
<pre><code>##   [1] 0.401250718 0.338515576 0.396332354 0.578554147 0.734569219 0.646225657
##   [7] 0.659347425 0.279690611 0.971464622 0.909361279 0.290900261 0.292791437
##  [13] 0.267267909 0.271017673 0.504350811 0.871855935 0.449328821 0.946699246
##  [19] 0.957965808 0.960507195 0.712888698 0.530048820 0.471838917 0.544474506
##  [25] 0.011592359 0.498958206 0.207201252 0.007666102 0.459115465 0.630061181
##  [31] 0.510702442 0.490455621 0.364781326 0.597607676 0.229307079 0.540385510
##  [37] 0.266631748 0.835029032 0.347008029 0.911450445 0.811536592 0.753593995
##  [43] 0.736702728 0.198078077 0.707606839 0.135540743 0.412555195 0.494881960
##  [49] 0.729018658 0.128366372 0.545582826 0.008203994 0.103955017 0.479320602
##  [55] 0.800867477 0.751880648 0.153600147 0.395349050 0.954801922 0.909394014
##  [61] 0.116682067 0.734460970 0.382799807 0.082367938 0.430418191 0.981639788
##  [67] 0.522740692 0.711716600 0.749590956 0.115366381 0.160905917 0.451615010
##  [73] 0.185955225 0.765149380 0.937118646 0.538188204 0.805422812 0.934597235
##  [79] 0.596175572 0.170190558 0.908692776 0.810633565 0.398558261 0.119841731
##  [85] 0.747911628 0.142342718 0.500865011 0.203452351 0.040998383 0.524777850
##  [91] 0.487271200 0.251246725 0.990868316 0.049779941 0.242787970 0.720719735
##  [97] 0.432998223 0.280773674 0.946954244 0.924366822</code></pre>
<p>Then, we get rid of the anonymous function by using <code>[[</code> directly:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="co"># get rid of the anonymous function by using [[ directly</span></span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="kw">sapply</span>(trials, <span class="st">`</span><span class="dt">[[</span><span class="st">`</span>, <span class="st">&#39;p.value&#39;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.401250718 0.338515576 0.396332354 0.578554147 0.734569219 0.646225657
##   [7] 0.659347425 0.279690611 0.971464622 0.909361279 0.290900261 0.292791437
##  [13] 0.267267909 0.271017673 0.504350811 0.871855935 0.449328821 0.946699246
##  [19] 0.957965808 0.960507195 0.712888698 0.530048820 0.471838917 0.544474506
##  [25] 0.011592359 0.498958206 0.207201252 0.007666102 0.459115465 0.630061181
##  [31] 0.510702442 0.490455621 0.364781326 0.597607676 0.229307079 0.540385510
##  [37] 0.266631748 0.835029032 0.347008029 0.911450445 0.811536592 0.753593995
##  [43] 0.736702728 0.198078077 0.707606839 0.135540743 0.412555195 0.494881960
##  [49] 0.729018658 0.128366372 0.545582826 0.008203994 0.103955017 0.479320602
##  [55] 0.800867477 0.751880648 0.153600147 0.395349050 0.954801922 0.909394014
##  [61] 0.116682067 0.734460970 0.382799807 0.082367938 0.430418191 0.981639788
##  [67] 0.522740692 0.711716600 0.749590956 0.115366381 0.160905917 0.451615010
##  [73] 0.185955225 0.765149380 0.937118646 0.538188204 0.805422812 0.934597235
##  [79] 0.596175572 0.170190558 0.908692776 0.810633565 0.398558261 0.119841731
##  [85] 0.747911628 0.142342718 0.500865011 0.203452351 0.040998383 0.524777850
##  [91] 0.487271200 0.251246725 0.990868316 0.049779941 0.242787970 0.720719735
##  [97] 0.432998223 0.280773674 0.946954244 0.924366822</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>Implement a combination of <code>Map()</code> and <code>vapply()</code> to create an <code>lapply()</code> variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<p>We do this by writing a function that uses <code>Map()</code> on a list of items, given input vectors that should be applied in parallel to this list of items. We need a combination of the arguments from vapply, and those from Map.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="co"># a combination of Map() and vapply()</span></span>
<span id="cb137-2"><a href="#cb137-2"></a>mcvMap &lt;-<span class="st"> </span><span class="cf">function</span>(x, f, FUN.VALUE, ...){</span>
<span id="cb137-3"><a href="#cb137-3"></a>  <span class="kw">vapply</span>(x, <span class="kw">Map</span>(f, ...), FUN.VALUE)</span>
<span id="cb137-4"><a href="#cb137-4"></a>}</span></code></pre></div>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.4. Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”. Compare the computation time of the two functions with the function “microbenchmark”. Comments your results.</p>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<p>As before, we implement the R function for Exercise 9.4, shown as:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)) <span class="co"># the Laplace function</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="co"># the function of standard Laplace distribution</span></span>
<span id="cb138-3"><a href="#cb138-3"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb138-4"><a href="#cb138-4"></a>  x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb138-5"><a href="#cb138-5"></a>  x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb138-6"><a href="#cb138-6"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb138-7"><a href="#cb138-7"></a>  k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb138-8"><a href="#cb138-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb138-9"><a href="#cb138-9"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb138-10"><a href="#cb138-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) <span class="co"># compare</span></span>
<span id="cb138-11"><a href="#cb138-11"></a>      x[i] =<span class="st"> </span>y </span>
<span id="cb138-12"><a href="#cb138-12"></a>    <span class="cf">else</span>{</span>
<span id="cb138-13"><a href="#cb138-13"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb138-14"><a href="#cb138-14"></a>      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb138-15"><a href="#cb138-15"></a>    }</span>
<span id="cb138-16"><a href="#cb138-16"></a>  }</span>
<span id="cb138-17"><a href="#cb138-17"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb138-18"><a href="#cb138-18"></a>}</span></code></pre></div>
<p>We can also implement the C++ function for Exercise 9.4, shown as:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="kw">sourceCpp</span>(</span>
<span id="cb139-3"><a href="#cb139-3"></a>  <span class="dt">code =</span> <span class="st">&#39;</span></span>
<span id="cb139-4"><a href="#cb139-4"></a><span class="st">    #include &lt;Rcpp.h&gt;</span></span>
<span id="cb139-5"><a href="#cb139-5"></a><span class="st">    #include &lt;random&gt;</span></span>
<span id="cb139-6"><a href="#cb139-6"></a><span class="st">    using namespace Rcpp;</span></span>
<span id="cb139-7"><a href="#cb139-7"></a><span class="st">    </span></span>
<span id="cb139-8"><a href="#cb139-8"></a><span class="st">    double lap(double x) {</span></span>
<span id="cb139-9"><a href="#cb139-9"></a><span class="st">      return exp(-abs(x));</span></span>
<span id="cb139-10"><a href="#cb139-10"></a><span class="st">    }</span></span>
<span id="cb139-11"><a href="#cb139-11"></a><span class="st">    </span></span>
<span id="cb139-12"><a href="#cb139-12"></a><span class="st">    // [[Rcpp::export]]</span></span>
<span id="cb139-13"><a href="#cb139-13"></a><span class="st">    List metropolisC(double sigma, double x0, int N) {</span></span>
<span id="cb139-14"><a href="#cb139-14"></a><span class="st">      std::default_random_engine generator_u;</span></span>
<span id="cb139-15"><a href="#cb139-15"></a><span class="st">      std::default_random_engine generator_n;</span></span>
<span id="cb139-16"><a href="#cb139-16"></a><span class="st">      std::uniform_real_distribution&lt;double&gt; distribution_u(0.0,1.0);</span></span>
<span id="cb139-17"><a href="#cb139-17"></a><span class="st">      NumericVector x(N);</span></span>
<span id="cb139-18"><a href="#cb139-18"></a><span class="st">      x[0] = x0;</span></span>
<span id="cb139-19"><a href="#cb139-19"></a><span class="st">      NumericVector u(N);</span></span>
<span id="cb139-20"><a href="#cb139-20"></a><span class="st">      for (int i = 0; i &lt; N; i++) {</span></span>
<span id="cb139-21"><a href="#cb139-21"></a><span class="st">        u[i] = distribution_u(generator_u);</span></span>
<span id="cb139-22"><a href="#cb139-22"></a><span class="st">      }</span></span>
<span id="cb139-23"><a href="#cb139-23"></a><span class="st">      int k = 0;</span></span>
<span id="cb139-24"><a href="#cb139-24"></a><span class="st">      for (int i = 1; i &lt; N; i++) {</span></span>
<span id="cb139-25"><a href="#cb139-25"></a><span class="st">        std::normal_distribution&lt;double&gt; distribution_n(x[i-1], sigma);</span></span>
<span id="cb139-26"><a href="#cb139-26"></a><span class="st">        double y = distribution_n(generator_n);</span></span>
<span id="cb139-27"><a href="#cb139-27"></a><span class="st">        if (u[i] &lt;= (lap(y) / lap(x[i-1])))</span></span>
<span id="cb139-28"><a href="#cb139-28"></a><span class="st">          x[i] = y;</span></span>
<span id="cb139-29"><a href="#cb139-29"></a><span class="st">        else {</span></span>
<span id="cb139-30"><a href="#cb139-30"></a><span class="st">          x[i] = x[i-1];</span></span>
<span id="cb139-31"><a href="#cb139-31"></a><span class="st">          k += 1;</span></span>
<span id="cb139-32"><a href="#cb139-32"></a><span class="st">        }</span></span>
<span id="cb139-33"><a href="#cb139-33"></a><span class="st">      }</span></span>
<span id="cb139-34"><a href="#cb139-34"></a><span class="st">      List out(2);</span></span>
<span id="cb139-35"><a href="#cb139-35"></a><span class="st">      out[0] = x;</span></span>
<span id="cb139-36"><a href="#cb139-36"></a><span class="st">      out[1] = k;</span></span>
<span id="cb139-37"><a href="#cb139-37"></a><span class="st">      return out;</span></span>
<span id="cb139-38"><a href="#cb139-38"></a><span class="st">    }</span></span>
<span id="cb139-39"><a href="#cb139-39"></a><span class="st">  &#39;</span></span>
<span id="cb139-40"><a href="#cb139-40"></a>)</span></code></pre></div>
<p>And we compare the corresponding generated random numbers with those by the R function we wrote before using the function <code>qqplot</code>, as</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="kw">set.seed</span>(<span class="dv">819</span>)</span>
<span id="cb140-2"><a href="#cb140-2"></a>N =<span class="st"> </span><span class="fl">1e3</span>; sigma =<span class="st"> </span><span class="fl">1.0</span>; x0 =<span class="st"> </span><span class="fl">25.0</span>;</span>
<span id="cb140-3"><a href="#cb140-3"></a>rw_r =<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dt">sigma =</span> sigma, <span class="dt">x0 =</span> x0, <span class="dt">N =</span> N)</span>
<span id="cb140-4"><a href="#cb140-4"></a>rw_c =<span class="st"> </span><span class="kw">metropolisC</span>(sigma, x0, N)</span>
<span id="cb140-5"><a href="#cb140-5"></a><span class="kw">qqnorm</span>(rw_r<span class="op">$</span>x, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">frame =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="kw">qqnorm</span>(rw_c[[<span class="dv">1</span>]], <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">frame =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Last, we compare the computation time of the two functions with the function <code>microbenchmark</code>, as:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb142-2"><a href="#cb142-2"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">MetropolisR=</span><span class="kw">rw.Metropolis</span>(sigma, x0, N), <span class="dt">MetropolisC=</span><span class="kw">metropolisC</span>(sigma, x0, N))</span>
<span id="cb142-3"><a href="#cb142-3"></a>    <span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##          expr        lq    median       uq
## 1 MetropolisR 5979.9010 7680.1010 8579.201
## 2 MetropolisC  294.7015  318.8505  354.251</code></pre>
<p>From the experiments, we can find that the numeric results of C++ function and R function is similar, but C++ function is faster than R function. It is amazing!</p>
</div>
</div>
<div id="reference" class="section level1">
<h1>Reference</h1>
<p>[1] James G , Witten D , Hastie T , et al. An Introduction to Statistical Learning[M]. Springer New York, 2013.</p>
<p>[2] Wickham, Hadley. Advanced r. CRC press, 2019.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
